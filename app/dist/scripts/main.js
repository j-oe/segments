!function(){!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("localforage",[],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.localforage=e()}}(function(){return function e(t,n,r){function i(a,l){if(!n[a]){if(!t[a]){var s="function"==typeof require&&require;if(!l&&s)return s(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[a]={exports:{}};t[a][0].call(d.exports,function(e){var n=t[a][1][e];return i(n||e)},d,d.exports,e,t,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,t,n){(function(e){"use strict";function n(){d=!0;for(var e,t,n=u.length;n;){for(t=u,u=[],e=-1;++e<n;)t[e]();n=u.length}d=!1}function r(e){1!==u.push(e)||d||i()}var i,o=e.MutationObserver||e.WebKitMutationObserver;if(o){var a=0,l=new o(n),s=e.document.createTextNode("");l.observe(s,{characterData:!0}),i=function(){s.data=a=++a%2}}else if(e.setImmediate||void 0===e.MessageChannel)i="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){n(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(n,0)};else{var c=new e.MessageChannel;c.port1.onmessage=n,i=function(){c.port2.postMessage(0)}}var d,u=[];t.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){"use strict";function r(){}function i(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=y,this.queue=[],this.outcome=void 0,e!==r&&s(this,e)}function o(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function a(e,t,n){m(function(){var r;try{r=t(n)}catch(t){return h.reject(e,t)}r===e?h.reject(e,new TypeError("Cannot resolve promise with itself")):h.resolve(e,r)})}function l(e){var t=e&&e.then;if(e&&"object"==typeof e&&"function"==typeof t)return function(){t.apply(e,arguments)}}function s(e,t){function n(t){o||(o=!0,h.reject(e,t))}function r(t){o||(o=!0,h.resolve(e,t))}function i(){t(r,n)}var o=!1,a=c(i);"error"===a.status&&n(a.value)}function c(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}function d(e){return e instanceof this?e:h.resolve(new this(r),e)}function u(e){var t=new this(r);return h.reject(t,e)}function f(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,i=!1;if(!n)return this.resolve([]);for(var o=new Array(n),a=0,l=-1,s=new this(r);++l<n;)!function(e,r){function l(e){o[r]=e,++a!==n||i||(i=!0,h.resolve(s,o))}t.resolve(e).then(l,function(e){i||(i=!0,h.reject(s,e))})}(e[l],l);return s}function p(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,i=!1;if(!n)return this.resolve([]);for(var o=-1,a=new this(r);++o<n;)!function(e){t.resolve(e).then(function(e){i||(i=!0,h.resolve(a,e))},function(e){i||(i=!0,h.reject(a,e))})}(e[o]);return a}var m=e(1),h={},v=["REJECTED"],g=["FULFILLED"],y=["PENDING"];t.exports=n=i,i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,t){if("function"!=typeof e&&this.state===g||"function"!=typeof t&&this.state===v)return this;var n=new this.constructor(r);if(this.state!==y){a(n,this.state===g?e:t,this.outcome)}else this.queue.push(new o(n,e,t));return n},o.prototype.callFulfilled=function(e){h.resolve(this.promise,e)},o.prototype.otherCallFulfilled=function(e){a(this.promise,this.onFulfilled,e)},o.prototype.callRejected=function(e){h.reject(this.promise,e)},o.prototype.otherCallRejected=function(e){a(this.promise,this.onRejected,e)},h.resolve=function(e,t){var n=c(l,t);if("error"===n.status)return h.reject(e,n.value);var r=n.value;if(r)s(e,r);else{e.state=g,e.outcome=t;for(var i=-1,o=e.queue.length;++i<o;)e.queue[i].callFulfilled(t)}return e},h.reject=function(e,t){e.state=v,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},n.resolve=d,n.reject=u,n.all=f,n.race=p},{1:1}],3:[function(e,t,n){(function(t){"use strict";"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(o){if("TypeError"!==o.name)throw o;for(var n="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,r=new n,i=0;i<e.length;i+=1)r.append(e[i]);return r.getBlob(t.type)}}function o(e,t){t&&e.then(function(e){t(null,e)},function(e){t(e)})}function a(e,t,n){"function"==typeof t&&e.then(t),"function"==typeof n&&e.catch(n)}function l(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),i=0;i<t;i++)r[i]=e.charCodeAt(i);return n}function s(e){return new oe(function(t){var n=e.transaction(ae,"readwrite"),r=i([""]);n.objectStore(ae).put(r,"key"),n.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},n.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);t(n||!e||parseInt(e[1],10)>=43)}}).catch(function(){return!1})}function c(e){return"boolean"==typeof re?oe.resolve(re):s(e).then(function(e){return re=e})}function d(e){var t=ie[e.name],n={};n.promise=new oe(function(e){n.resolve=e}),t.deferredOperations.push(n),t.dbReady?t.dbReady=t.dbReady.then(function(){return n.promise}):t.dbReady=n.promise}function u(e){var t=ie[e.name],n=t.deferredOperations.pop();n&&n.resolve()}function f(e,t){return new oe(function(n,r){if(e.db){if(!t)return n(e.db);d(e),e.db.close()}var i=[e.name];t&&i.push(e.version);var o=ne.open.apply(ne,i);t&&(o.onupgradeneeded=function(t){var n=o.result;try{n.createObjectStore(e.storeName),t.oldVersion<=1&&n.createObjectStore(ae)}catch(n){if("ConstraintError"!==n.name)throw n;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),o.onerror=function(e){e.preventDefault(),r(o.error)},o.onsuccess=function(){n(o.result),u(e)}})}function p(e){return f(e,!1)}function m(e){return f(e,!0)}function h(e,t){if(!e.db)return!0;var n=!e.db.objectStoreNames.contains(e.storeName),r=e.version<e.db.version,i=e.version>e.db.version;if(r&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),i||n){if(n){var o=e.db.version+1;o>e.version&&(e.version=o)}return!0}return!1}function v(e){return new oe(function(t,n){var r=new FileReader;r.onerror=n,r.onloadend=function(n){var r=btoa(n.target.result||"");t({__local_forage_encoded_blob:!0,data:r,type:e.type})},r.readAsBinaryString(e)})}function g(e){return i([l(atob(e.data))],{type:e.type})}function y(e){return e&&e.__local_forage_encoded_blob}function w(e){var t=this,n=t._initReady().then(function(){var e=ie[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady});return a(n,e,e),n}function b(e){function t(){return oe.resolve()}var n=this,r={db:null};if(e)for(var i in e)r[i]=e[i];ie||(ie={});var o=ie[r.name];o||(o={forages:[],db:null,dbReady:null,deferredOperations:[]},ie[r.name]=o),o.forages.push(n),n._initReady||(n._initReady=n.ready,n.ready=w);for(var a=[],l=0;l<o.forages.length;l++){var s=o.forages[l];s!==n&&a.push(s._initReady().catch(t))}var c=o.forages.slice(0);return oe.all(a).then(function(){return r.db=o.db,p(r)}).then(function(e){return r.db=e,h(r,n._defaultConfig.version)?m(r):e}).then(function(e){r.db=o.db=e,n._dbInfo=r;for(var t=0;t<c.length;t++){var i=c[t];i!==n&&(i._dbInfo.db=r.db,i._dbInfo.version=r.version)}})}function _(e,t){var n=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=new oe(function(t,r){n.ready().then(function(){var i=n._dbInfo,o=i.db.transaction(i.storeName,"readonly").objectStore(i.storeName),a=o.get(e);a.onsuccess=function(){var e=a.result;void 0===e&&(e=null),y(e)&&(e=g(e)),t(e)},a.onerror=function(){r(a.error)}}).catch(r)});return o(r,t),r}function x(e,t){var n=this,r=new oe(function(t,r){n.ready().then(function(){var i=n._dbInfo,o=i.db.transaction(i.storeName,"readonly").objectStore(i.storeName),a=o.openCursor(),l=1;a.onsuccess=function(){var n=a.result;if(n){var r=n.value;y(r)&&(r=g(r));var i=e(r,n.key,l++);void 0!==i?t(i):n.continue()}else t()},a.onerror=function(){r(a.error)}}).catch(r)});return o(r,t),r}function S(e,t,n){var r=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var i=new oe(function(n,i){var o;r.ready().then(function(){return o=r._dbInfo,"[object Blob]"===le.call(t)?c(o.db).then(function(e){return e?t:v(t)}):t}).then(function(t){var r=o.db.transaction(o.storeName,"readwrite"),a=r.objectStore(o.storeName),l=a.put(t,e);null===t&&(t=void 0),r.oncomplete=function(){void 0===t&&(t=null),n(t)},r.onabort=r.onerror=function(){var e=l.error?l.error:l.transaction.error;i(e)}}).catch(i)});return o(i,n),i}function k(e,t){var n=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=new oe(function(t,r){n.ready().then(function(){var i=n._dbInfo,o=i.db.transaction(i.storeName,"readwrite"),a=o.objectStore(i.storeName),l=a.delete(e);o.oncomplete=function(){t()},o.onerror=function(){r(l.error)},o.onabort=function(){var e=l.error?l.error:l.transaction.error;r(e)}}).catch(r)});return o(r,t),r}function M(e){var t=this,n=new oe(function(e,n){t.ready().then(function(){var r=t._dbInfo,i=r.db.transaction(r.storeName,"readwrite"),o=i.objectStore(r.storeName),a=o.clear();i.oncomplete=function(){e()},i.onabort=i.onerror=function(){var e=a.error?a.error:a.transaction.error;n(e)}}).catch(n)});return o(n,e),n}function A(e){var t=this,n=new oe(function(e,n){t.ready().then(function(){var r=t._dbInfo,i=r.db.transaction(r.storeName,"readonly").objectStore(r.storeName),o=i.count();o.onsuccess=function(){e(o.result)},o.onerror=function(){n(o.error)}}).catch(n)});return o(n,e),n}function E(e,t){var n=this,r=new oe(function(t,r){if(e<0)return void t(null);n.ready().then(function(){var i=n._dbInfo,o=i.db.transaction(i.storeName,"readonly").objectStore(i.storeName),a=!1,l=o.openCursor();l.onsuccess=function(){var n=l.result;if(!n)return void t(null);0===e?t(n.key):a?t(n.key):(a=!0,n.advance(e))},l.onerror=function(){r(l.error)}}).catch(r)});return o(r,t),r}function L(e){var t=this,n=new oe(function(e,n){t.ready().then(function(){var r=t._dbInfo,i=r.db.transaction(r.storeName,"readonly").objectStore(r.storeName),o=i.openCursor(),a=[];o.onsuccess=function(){var t=o.result;if(!t)return void e(a);a.push(t.key),t.continue()},o.onerror=function(){n(o.error)}}).catch(n)});return o(n,e),n}function D(e){var t,n,r,i,o,a=.75*e.length,l=e.length,s=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var c=new ArrayBuffer(a),d=new Uint8Array(c);for(t=0;t<l;t+=4)n=ce.indexOf(e[t]),r=ce.indexOf(e[t+1]),i=ce.indexOf(e[t+2]),o=ce.indexOf(e[t+3]),d[s++]=n<<2|r>>4,d[s++]=(15&r)<<4|i>>2,d[s++]=(3&i)<<6|63&o;return c}function C(e){var t,n=new Uint8Array(e),r="";for(t=0;t<n.length;t+=3)r+=ce[n[t]>>2],r+=ce[(3&n[t])<<4|n[t+1]>>4],r+=ce[(15&n[t+1])<<2|n[t+2]>>6],r+=ce[63&n[t+2]];return n.length%3==2?r=r.substring(0,r.length-1)+"=":n.length%3==1&&(r=r.substring(0,r.length-2)+"=="),r}function I(e,t){var n="";if(e&&(n=Ae.call(e)),e&&("[object ArrayBuffer]"===n||e.buffer&&"[object ArrayBuffer]"===Ae.call(e.buffer))){var r,i=fe;e instanceof ArrayBuffer?(r=e,i+=me):(r=e.buffer,"[object Int8Array]"===n?i+=ve:"[object Uint8Array]"===n?i+=ge:"[object Uint8ClampedArray]"===n?i+=ye:"[object Int16Array]"===n?i+=we:"[object Uint16Array]"===n?i+=_e:"[object Int32Array]"===n?i+=be:"[object Uint32Array]"===n?i+=xe:"[object Float32Array]"===n?i+=Se:"[object Float64Array]"===n?i+=ke:t(new Error("Failed to get type for BinaryArray"))),t(i+C(r))}else if("[object Blob]"===n){var o=new FileReader;o.onload=function(){var n=de+e.type+"~"+C(this.result);t(fe+he+n)},o.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(n){console.error("Couldn't convert value into a JSON string: ",e),t(null,n)}}function j(e){if(e.substring(0,pe)!==fe)return JSON.parse(e);var t,n=e.substring(Me),r=e.substring(pe,Me);if(r===he&&ue.test(n)){var o=n.match(ue);t=o[1],n=n.substring(o[0].length)}var a=D(n);switch(r){case me:return a;case he:return i([a],{type:t});case ve:return new Int8Array(a);case ge:return new Uint8Array(a);case ye:return new Uint8ClampedArray(a);case we:return new Int16Array(a);case _e:return new Uint16Array(a);case be:return new Int32Array(a);case xe:return new Uint32Array(a);case Se:return new Float32Array(a);case ke:return new Float64Array(a);default:throw new Error("Unkown type: "+r)}}function O(e){var t=this,n={db:null};if(e)for(var r in e)n[r]="string"!=typeof e[r]?e[r].toString():e[r];var i=new oe(function(e,r){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(e){return r(e)}n.db.transaction(function(i){i.executeSql("CREATE TABLE IF NOT EXISTS "+n.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],function(){t._dbInfo=n,e()},function(e,t){r(t)})})});return n.serializer=Ee,i}function T(e,t){var n=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=new oe(function(t,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){n.executeSql("SELECT * FROM "+i.storeName+" WHERE key = ? LIMIT 1",[e],function(e,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=i.serializer.deserialize(r)),t(r)},function(e,t){r(t)})})}).catch(r)});return o(r,t),r}function N(e,t){var n=this,r=new oe(function(t,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){n.executeSql("SELECT * FROM "+i.storeName,[],function(n,r){for(var o=r.rows,a=o.length,l=0;l<a;l++){var s=o.item(l),c=s.value;if(c&&(c=i.serializer.deserialize(c)),void 0!==(c=e(c,s.key,l+1)))return void t(c)}t()},function(e,t){r(t)})})}).catch(r)});return o(r,t),r}function P(e,t,n,r){var i=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var a=new oe(function(o,a){i.ready().then(function(){void 0===t&&(t=null);var l=t,s=i._dbInfo;s.serializer.serialize(t,function(t,c){c?a(c):s.db.transaction(function(n){n.executeSql("INSERT OR REPLACE INTO "+s.storeName+" (key, value) VALUES (?, ?)",[e,t],function(){o(l)},function(e,t){a(t)})},function(t){if(t.code===t.QUOTA_ERR){if(r>0)return void o(P.apply(i,[e,l,n,r-1]));a(t)}})})}).catch(a)});return o(a,n),a}function F(e,t,n){return P.apply(this,[e,t,n,1])}function R(e,t){var n=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=new oe(function(t,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){n.executeSql("DELETE FROM "+i.storeName+" WHERE key = ?",[e],function(){t()},function(e,t){r(t)})})}).catch(r)});return o(r,t),r}function z(e){var t=this,n=new oe(function(e,n){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){t.executeSql("DELETE FROM "+r.storeName,[],function(){e()},function(e,t){n(t)})})}).catch(n)});return o(n,e),n}function q(e){var t=this,n=new oe(function(e,n){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){t.executeSql("SELECT COUNT(key) as c FROM "+r.storeName,[],function(t,n){var r=n.rows.item(0).c;e(r)},function(e,t){n(t)})})}).catch(n)});return o(n,e),n}function B(e,t){var n=this,r=new oe(function(t,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){n.executeSql("SELECT key FROM "+i.storeName+" WHERE id = ? LIMIT 1",[e+1],function(e,n){var r=n.rows.length?n.rows.item(0).key:null;t(r)},function(e,t){r(t)})})}).catch(r)});return o(r,t),r}function W(e){var t=this,n=new oe(function(e,n){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){t.executeSql("SELECT key FROM "+r.storeName,[],function(t,n){for(var r=[],i=0;i<n.rows.length;i++)r.push(n.rows.item(i).key);e(r)},function(e,t){n(t)})})}).catch(n)});return o(n,e),n}function U(e){var t=this,n={};if(e)for(var r in e)n[r]=e[r];return n.keyPrefix=n.name+"/",n.storeName!==t._defaultConfig.storeName&&(n.keyPrefix+=n.storeName+"/"),t._dbInfo=n,n.serializer=Ee,oe.resolve()}function H(e){var t=this,n=t.ready().then(function(){for(var e=t._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var r=localStorage.key(n);0===r.indexOf(e)&&localStorage.removeItem(r)}});return o(n,e),n}function X(e,t){var n=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=n.ready().then(function(){var t=n._dbInfo,r=localStorage.getItem(t.keyPrefix+e);return r&&(r=t.serializer.deserialize(r)),r});return o(r,t),r}function V(e,t){var n=this,r=n.ready().then(function(){for(var t=n._dbInfo,r=t.keyPrefix,i=r.length,o=localStorage.length,a=1,l=0;l<o;l++){var s=localStorage.key(l);if(0===s.indexOf(r)){var c=localStorage.getItem(s);if(c&&(c=t.serializer.deserialize(c)),void 0!==(c=e(c,s.substring(i),a++)))return c}}});return o(r,t),r}function J(e,t){var n=this,r=n.ready().then(function(){var t,r=n._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(r.keyPrefix.length)),t});return o(r,t),r}function Q(e){var t=this,n=t.ready().then(function(){for(var e=t._dbInfo,n=localStorage.length,r=[],i=0;i<n;i++)0===localStorage.key(i).indexOf(e.keyPrefix)&&r.push(localStorage.key(i).substring(e.keyPrefix.length));return r});return o(n,e),n}function $(e){var t=this,n=t.keys().then(function(e){return e.length});return o(n,e),n}function G(e,t){var n=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=n.ready().then(function(){var t=n._dbInfo;localStorage.removeItem(t.keyPrefix+e)});return o(r,t),r}function K(e,t,n){var r=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var i=r.ready().then(function(){void 0===t&&(t=null);var n=t;return new oe(function(i,o){var a=r._dbInfo;a.serializer.serialize(t,function(t,r){if(r)o(r);else try{localStorage.setItem(a.keyPrefix+e,t),i(n)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||o(e),o(e)}})})});return o(i,n),i}function Z(e,t){e[t]=function(){var n=arguments;return e.ready().then(function(){return e[t].apply(e,n)})}}function Y(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var n in t)t.hasOwnProperty(n)&&(Pe(t[n])?arguments[0][n]=t[n].slice():arguments[0][n]=t[n])}return arguments[0]}function ee(e){for(var t in Ie)if(Ie.hasOwnProperty(t)&&Ie[t]===e)return!0;return!1}var te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},ne=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){}}();"undefined"==typeof Promise&&e(3);var re,ie,oe=Promise,ae="local-forage-detect-blob-support",le=Object.prototype.toString,se={_driver:"asyncStorage",_initStorage:b,iterate:x,getItem:_,setItem:S,removeItem:k,clear:M,length:A,key:E,keys:L},ce="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",de="~~local_forage_type~",ue=/^~~local_forage_type~([^~]+)~/,fe="__lfsc__:",pe=fe.length,me="arbf",he="blob",ve="si08",ge="ui08",ye="uic8",we="si16",be="si32",_e="ur16",xe="ui32",Se="fl32",ke="fl64",Me=pe+me.length,Ae=Object.prototype.toString,Ee={serialize:I,deserialize:j,stringToBuffer:D,bufferToString:C},Le={_driver:"webSQLStorage",_initStorage:O,iterate:N,getItem:T,setItem:F,removeItem:R,clear:z,length:q,key:B,keys:W},De={_driver:"localStorageWrapper",_initStorage:U,iterate:V,getItem:X,setItem:K,removeItem:G,clear:H,length:$,key:J,keys:Q},Ce={},Ie={INDEXEDDB:"asyncStorage",LOCALSTORAGE:"localStorageWrapper",WEBSQL:"webSQLStorage"},je=[Ie.INDEXEDDB,Ie.WEBSQL,Ie.LOCALSTORAGE],Oe=["clear","getItem","iterate","key","keys","length","removeItem","setItem"],Te={description:"",driver:je.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},Ne={};Ne[Ie.INDEXEDDB]=function(){try{if(!ne)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}(),Ne[Ie.WEBSQL]=function(){return"function"==typeof openDatabase}(),Ne[Ie.LOCALSTORAGE]=function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&localStorage.setItem}catch(e){return!1}}();var Pe=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Fe=function(){function e(t){r(this,e),this.INDEXEDDB=Ie.INDEXEDDB,this.LOCALSTORAGE=Ie.LOCALSTORAGE,this.WEBSQL=Ie.WEBSQL,this._defaultConfig=Y({},Te),this._config=Y({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":te(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e&&e.driver)||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,n){var r=new oe(function(t,n){try{var r=e._driver,i=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver"),o=new Error("Custom driver name already in use: "+e._driver);if(!e._driver)return void n(i);if(ee(e._driver))return void n(o);for(var a=Oe.concat("_initStorage"),l=0;l<a.length;l++){var s=a[l];if(!s||!e[s]||"function"!=typeof e[s])return void n(i)}var c=oe.resolve(!0);"_support"in e&&(c=e._support&&"function"==typeof e._support?e._support():oe.resolve(!!e._support)),c.then(function(n){Ne[r]=n,Ce[r]=e,t()},n)}catch(e){n(e)}});return a(r,t,n),r},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,n){var r=this,i=oe.resolve().then(function(){if(!ee(e)){if(Ce[e])return Ce[e];throw new Error("Driver not found.")}switch(e){case r.INDEXEDDB:return se;case r.LOCALSTORAGE:return De;case r.WEBSQL:return Le}});return a(i,t,n),i},e.prototype.getSerializer=function(e){var t=oe.resolve(Ee);return a(t,e),t},e.prototype.ready=function(e){var t=this,n=t._driverSet.then(function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready});return a(n,e,e),n},e.prototype.setDriver=function(e,t,n){function r(){l._config.driver=l.driver()}function i(e){return l._extend(e),r(),l._ready=l._initStorage(l._config),l._ready}function o(e){return function(){function t(){for(;n<e.length;){var o=e[n];return n++,l._dbInfo=null,l._ready=null,l.getDriver(o).then(i).catch(t)}r();var a=new Error("No available storage method found.");return l._driverSet=oe.reject(a),l._driverSet}var n=0;return t()}}var l=this;Pe(e)||(e=[e]);var s=this._getSupportedDrivers(e),c=null!==this._driverSet?this._driverSet.catch(function(){return oe.resolve()}):oe.resolve();return this._driverSet=c.then(function(){var e=s[0];return l._dbInfo=null,l._ready=null,l.getDriver(e).then(function(e){l._driver=e._driver,r(),l._wrapLibraryMethodsWithReady(),l._initDriver=o(s)})}).catch(function(){r();var e=new Error("No available storage method found.");return l._driverSet=oe.reject(e),l._driverSet}),a(this._driverSet,t,n),this._driverSet},e.prototype.supports=function(e){return!!Ne[e]},e.prototype._extend=function(e){Y(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];this.supports(i)&&t.push(i)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0;e<Oe.length;e++)Z(this,Oe[e])},e.prototype.createInstance=function(t){return new e(t)},e}(),Re=new Fe;t.exports=Re},{3:3}]},{},[4])(4)}),define("controller/local",["localforage"],function(e){var t={idx:"fc_index",key:"fc_license",set:"fc_settings",init:function(){var n=localStorage.getItem(t.idx),r=localStorage.getItem(t.set);null===n&&localStorage.setItem(t.idx,"[]"),null!==r&&t.loadSettings(),e.config({name:"fastclass"})},getKey:function(){return localStorage.getItem(t.idx)},clear:function(){return localStorage.clear(),e.clear()},getModels:function(){return t._getIndex().filter(function(e){return"model"===e.type})},getReports:function(){return t._getIndex().filter(function(e){return"report"===e.type})},storeModel:function(n){var r=n.meta.modelID,i=n.meta.modelName;return t._addModelToIndex(r,i,"model"),e.setItem(r,n)},storeReport:function(n){var r=n.meta.reportID,i=n.meta.reportName;return t._addModelToIndex(r,i,"report"),e.setItem(r,n)},loadModel:function(t){return e.getItem(t)},deleteModel:function(n){return t._removeModelFromIndex(n),e.removeItem(n)},saveSettings:function(e){localStorage.setItem(t.set,JSON.stringify(e))},loadSettings:function(){return localStorage.getItem(t.set)},resetSettings:function(){localStorage.removeItem(t.set)},_getIndex:function(e){return JSON.parse(localStorage.getItem(t.idx))},_updateIndex:function(e){localStorage.setItem(t.idx,JSON.stringify(e))},_addModelToIndex:function(e,n,r){var i=t._getIndex();i.push({id:e,name:n,type:r}),t._updateIndex(i)},_removeModelFromIndex:function(e){var n=t._getIndex(),r=n.map(function(e){return e.id}).indexOf(e);n.splice(r,1),t._updateIndex(n)}};return t});var e=document.documentElement.lang||"de";define("helper/l10n",["../../res/lang/"+e],function(t){return function(n){switch(typeof n){case"string":return t.hasOwnProperty(n)?t[n]:"MISSING LABEL for "+n;case"object":return n.hasOwnProperty(e)?n[e]:"MISSING LANGUAGE for "+n}}}),define("config/params",["controller/local","helper/l10n"],function(e,t){var n={nrOfNgrams:{label:"Word groups",value:void 0,defaultValue:2,writable:!0,type:"list",values:[{text:"n = {1,2,3}",value:-3},{text:"n = {1,2}",value:-2},{text:"n = 1",value:1},{text:"n = 2",value:2},{text:"n = 3",value:3},{text:"n = 4",value:4}]},similarityCalc:{label:"Similarity measure",value:void 0,defaultValue:"cosine",writable:!0,type:"list",values:[{text:"Cosine",value:"cosine"},{text:"L1 / Manhattan",value:"l1"},{text:"Test measure",value:"custom"}]},weightingCalc:{label:"Weighting",value:void 0,defaultValue:"tf-icf-cf",writable:!0,type:"list",values:[{text:"TF-ICF-CF",value:"tf-icf-cf"},{text:"TF-IDF-CF",value:"tf-idf-cf"},{text:"TF-IDF",value:"tf-idf"},{text:"TF-IDF (smooth)",value:"tf-idf-s"}]},normalizeWeights:{label:"Normalize weighting",value:void 0,defaultValue:!0,writable:!0,type:"boolean"},minNrOfTokens:{label:"Minimum nr. of tokens",value:void 0,defaultValue:1,writable:!0,type:"range",values:{min:0,max:5,step:1}},minLengthOfTokens:{label:"Minimum length of token",value:void 0,defaultValue:0,writable:!0,type:"range",values:{min:0,max:10,step:1}},tokenWeighting:{label:"Token weighting value",value:void 0,defaultValue:1,writable:!1,type:"range",values:{min:1,max:100,step:.5}},signalsEnabled:{label:"Semantic weighting",value:void 0,defaultValue:!1,writable:!0,type:"boolean"},signalWeighting:{label:"Semantic weighting value",value:void 0,defaultValue:10,writable:!0,type:"range",values:{min:1,max:100,step:.5}},rangeThreshold:{label:"PDF range finding threshold",value:void 0,defaultValue:0,writable:!1,type:"range",values:{min:0,max:50,step:1}},confidenceThreshold:{label:"Confidence Threshold",value:void 0,defaultValue:70,writable:!1,type:"range",values:{min:0,max:100,step:.5}},similarityThreshold:{label:"Similarity Threshold",value:void 0,defaultValue:90,writable:!1,type:"range",values:{min:0,max:100,step:.5}},verboseReporting:{label:"Ausführliche Berichte",value:void 0,defaultValue:!1,writable:!1,type:"boolean"},indicators:{label:"Indikatoren",value:void 0,defaultValue:!0,writable:!1,type:"boolean"},appIRI:{label:"Identifier der Anwendung",value:"http://dev.fastclass.de",writable:!1,type:"string"},appName:{label:"Name der Anwendung",value:"fastclass DevPreview",writable:!1,type:"string"},enabledImports:{label:"Import-Formate",value:{train:["fcm","xml","json"],classify:["xml","json","pdf"],similarity:["xml","json","zip"]},writable:!1,type:"object"},enabledExports:{label:"Export-Formate",value:{train:["inputdata-json","local-model"],classify:["range-json","clf-full-json","iirds-rdf"],report:["sim-json","sim-csv","fcr","local-report"],config:["fc-config"],quality:["qa-json"]},writable:!1,type:"object"},configurationDownloadable:{label:"Konfiguration downloadbar",value:void 0,defaultValue:!0,writable:!1,type:"boolean"},fcWorkerURL:{value:"scripts/worker/fastclass-worker.js",writable:!1,type:"string"},waWorkerURL:{value:"scripts/worker/annotation-worker.js",writable:!1,type:"string"},rgWorkerURL:{value:"scripts/worker/range-worker2.js",writable:!1,type:"string"},smWorkerURL:{value:"scripts/worker/similarities-worker.js",writable:!1,type:"string"},dfWorkerURL:{value:"scripts/worker/diffing-worker.js",writable:!1,type:"string"},demoFiles:{value:{fcm:{de:"../src/res/data/democ.fcm",en:"../res/data/demo.en.fcm"},pdf:{de:"../src/res/data/pdf.json",en:"../res/data/pdf.en.json"}},type:"object",writable:!1},indicatorValues:{value:{nrOfObjects:{type:"scale",values:[100,1e3]},nrOfClasses:{type:"range",values:[2,20,40]},sizeOfObjects:{type:"range",values:[50,500,1e3]},timeElapsed:{type:"scale",values:[100,0]}},type:"object",writable:!1}},r={setParam:function(t,i,o){n.hasOwnProperty(t)?n[t].writable&&(n[t].value=i,o||e.saveSettings(r.getConfig())):console.log("tried to set unknown param: ",t)},getParam:function(e){if(n.hasOwnProperty(e))return void 0===n[e].value?n[e].defaultValue:n[e].value;console.log("tried to get unknown param: ",e)},getCompleteConfig:function(e){return n},getWritableConfig:function(e){var t={};return Object.keys(n).forEach(function(e){n[e].writable&&(t[e]=n[e])}),t},getConfig:function(){var e={};return Object.keys(n).forEach(function(t){e[t]=r.getParam(t)}),e},loadConfig:function(e){Object.keys(e).forEach(function(t){r.setParam(t,e[t],!0)})},resetConfig:function(){Object.keys(n).forEach(function(e){r.setParam(e,n[e].defaultValue,!0)})}};return r}),define("model",{model:{conf:{},meta:{modelVersion:"0.2"},data:{matrix:[],object:{}}},isAvailable:function(){return!!(this.model.data.matrix&&this.model.data.matrix.length>0)},isExtendable:function(){return!(!this.hasObject()||!this.hasConfig())},hasObject:function(){return!!(this.model.data.object&&this.model.data.object["@cls"]>0)},hasConfig:function(){return!!(this.model.conf&&Object.keys(this.model.conf).length>0)},getName:function(){return this.isAvailable()?this.model.meta.modelName&&""!==this.model.meta.modelName?this.model.meta.modelName:"Unnamed model":"No model available"}}),define("helper/util",[],function(){var e={browserHasFunctionality:function(){
var e=window.Worker&&window.File&&window.FileReader&&window.DOMParser&&window.fetch&&Object.keys&&Object.assign,t=/Trident/i.test(navigator.userAgent);return e&&!t},stripURL:function(e){return e&&-1!==e.indexOf("#")?e.substring(e.indexOf("#")+1):"start"},makeUnique:function(e){for(var t={},n=0;n<e.length;n++)t[e[n]]=!0;return Object.keys(t)},pushArray:function(e,t){return Array.prototype.push.apply(e,t),e},indexOfMax:function(e){for(var t=e[0],n=0,r=1;r<e.length;r++)e[r]>t&&(n=r,t=e[r]);return n},getClassDistribution:function(e){var t=[];if(e.constructor===Object)for(var n in e)"@"!==n.substring(0,1)&&t.push({label:n,value:e[n]["@total"]});else{for(var r={},i=0;i<e.length;i++)r[e[i].clf]=r[e[i].clf]+1||1;for(var o in r)t.push({label:o,value:r[o]})}return t},copyObject:function(e){return JSON.parse(JSON.stringify(e))},createFileName:function(e){return"fastclass_"+e.replace(/\s+/g,"-").replace(/[@,\.;:\?!\\§$%&#\/\(\)=\+±`'‚’„“”"\*´°><^\[\]]+/g,"")},requireCSS:function(e){if(!1===Array.prototype.slice.call(document.getElementsByTagName("link")).some(function(t){return t.attributes.href.value===e})){var t=document.createElement("link");t.type="text/css",t.rel="stylesheet",t.href=e,document.getElementsByTagName("head")[0].appendChild(t)}},downloadFile:function(t,n,r){var i=r?t:JSON.stringify(t),o=new Blob([i],{type:"octet/stream"});e.downloadBlob(o,n)},downloadBlob:function(e,t){var n=window.URL.createObjectURL(e),r=document.createElement("a");r.download=t,r.href=n,r.click(),r.remove(),window.URL.revokeObjectURL(n)},getUUID:function(e){var t=(new Date).getTime();return(e||"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx").replace(/[xy]/g,function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?n:3&n|8).toString(16)})},hashString:function(e){var t,n,r=0;if(0===this.length)return r;for(t=0;t<this.length;t++)n=this.charCodeAt(t),r=(r<<5)-r+n,r|=0;return r},findOverlap:function(t,n){return 0===n.length?"":t.endsWith(n)?n:t.indexOf(n)>=0?n:e.findOverlap(t,n.substring(0,n.length-1))},getSlug:function(e){e=e.replace(/^\s+|\s+$/g,""),e=e.toLowerCase();for(var t="àáäâèéëêìíïîòóöôùúüûñç·/_,:;",n="aaaaeeeeiiiioooouuuunc------",r=0,i=t.length;r<i;r++)e=e.replace(new RegExp(t.charAt(r),"g"),n.charAt(r));return e=e.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-")},getLocale:function(){return document.documentElement.lang},getTime:function(){return performance?performance.now():Date.now()},getDateString:function(){return(new Date).toISOString()},round:function(e,t){var n=t||0;return Math.round(e*Math.pow(10,n))/Math.pow(10,n)},percent:function(t,n,r){if(t&&n&&0!==n)return e.round(t/n*100,r)+"%"}};return e}),define("view/ui",["helper/l10n","helper/util"],function(e,t){var n={e:function(e){return""!==e&&void 0!==e?document.getElementById(e):null},q:function(e){var t=document.querySelectorAll(e);return Array.prototype.slice.call(t)},qA:function(e){return document.querySelectorAll(e)},show:function(e,t){Array.isArray(e)?e.forEach(function(e){n.show(e,t)}):"none"===n.e(e).style.display&&(n.e(e).style.display=t||"block")},hide:function(e){if(Array.isArray(e))e.forEach(function(e){n.hide(e)});else{n.e(e)&&"none"!==n.e(e).style.display&&(n.e(e).style.display="none")}},loading:function(e,t){Array.isArray(e)?e.forEach(function(e){n.loading(e,t)}):e&&(void 0===t&&n.e(e).classList.toggle("loading"),!0===t&&n.e(e).classList.add("loading"),!1===t&&n.e(e).classList.remove("loading"))},create:function(e){return document.createElement(e)},append:function(e,t){Array.isArray(t)?t.forEach(function(t){n.append(e,t)}):t&&e.appendChild(t)},content:function(e,t){if(e===Object(e))for(var r in e)n.content(r,e[r]);else n.e(e).innerHTML=t},empty:function(e){if(Array.isArray(e))e.forEach(function(e){n.empty(e)});else{var t=n.e(e);if(t.firstChild)for(;t.firstChild;)t.removeChild(t.firstChild)}},bind:function(e,t,r){n.e(e)&&n.e(e).addEventListener(t,r)},click:function(e,t){Array.isArray(e)?e.forEach(function(e){n.click(e,t)}):n.bind(e,"click",function(r){n.loading(e),t(r)})},change:function(e,t){n.bind(e,"change",t)},showModal:function(t,r,i){var o=r||e("modal_title_error");n.content({"modal-title":o,"modal-content":t}),n.e("modal").classList.add("active")},closeModal:function(e){n.loading(["modal-ok","modal-x"],!1),n.e("modal").classList.remove("active")},unlockPanels:function(){n.hide(["panel_classify_warning"]),n.show(["classificationData"]),n.q(".dropdown .disabled").forEach(function(e){e.classList.remove("disabled")})},showPanel:function(e){n.q("section").forEach(function(e){n.hide(e.id)}),e&&n.show("panel_"+e)}};return n}),define("controller/store",{modelTemplate:{conf:{},meta:{},data:{matrix:[],object:{}}},currentModel:{},model:{conf:{},meta:{},data:{matrix:[],object:{}}},report:{meta:{}},registeredHandlers:[],xmlDocuments:[],xmlDocumentsCl:[],xmlParsingOptions:[],pdfArrayBuffer:{},pdfBulkFiles:[],inputData:[],inputDataCl:[],inputDataRp:[],classifiedData:[],classifiedFileSources:[],classifiedFileCurrentType:void 0,repProblematicModules:[],repSimilarModules:{conf:{},meta:{},data:{results:[],mapping:{},sources:[]}},repAnnotations:[]}),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("diff",[],t):"object"==typeof exports?exports.JsDiff=t():e.JsDiff=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";t.__esModule=!0,t.canonicalize=t.convertChangesToXML=t.convertChangesToDMP=t.merge=t.parsePatch=t.applyPatches=t.applyPatch=t.createPatch=t.createTwoFilesPatch=t.structuredPatch=t.diffArrays=t.diffJson=t.diffCss=t.diffSentences=t.diffTrimmedLines=t.diffLines=t.diffWordsWithSpace=t.diffWords=t.diffChars=t.Diff=void 0;var r=n(1),i=function(e){return e&&e.__esModule?e:{default:e}}(r),o=n(2),a=n(3),l=n(5),s=n(6),c=n(7),d=n(8),u=n(9),f=n(10),p=n(11),m=n(13),h=n(14),v=n(16),g=n(17);t.Diff=i.default,t.diffChars=o.diffChars,t.diffWords=a.diffWords,t.diffWordsWithSpace=a.diffWordsWithSpace,t.diffLines=l.diffLines,t.diffTrimmedLines=l.diffTrimmedLines,t.diffSentences=s.diffSentences,t.diffCss=c.diffCss,t.diffJson=d.diffJson,t.diffArrays=u.diffArrays,t.structuredPatch=h.structuredPatch,t.createTwoFilesPatch=h.createTwoFilesPatch,t.createPatch=h.createPatch,t.applyPatch=f.applyPatch,t.applyPatches=f.applyPatches,t.parsePatch=p.parsePatch,t.merge=m.merge,t.convertChangesToDMP=v.convertChangesToDMP,t.convertChangesToXML=g.convertChangesToXML,t.canonicalize=d.canonicalize},function(e,t){"use strict";function n(){}function r(e,t,n,r,i){for(var o=0,a=t.length,l=0,s=0;o<a;o++){var c=t[o];if(c.removed){if(c.value=e.join(r.slice(s,s+c.count)),s+=c.count,o&&t[o-1].added){var d=t[o-1];t[o-1]=t[o],t[o]=d}}else{if(!c.added&&i){var u=n.slice(l,l+c.count);u=u.map(function(e,t){var n=r[s+t];return n.length>e.length?n:e}),c.value=e.join(u)}else c.value=e.join(n.slice(l,l+c.count));l+=c.count,c.added||(s+=c.count)}}var f=t[a-1];return a>1&&(f.added||f.removed)&&e.equals("",f.value)&&(t[a-2].value+=f.value,t.pop()),t}function i(e){return{newPos:e.newPos,components:e.components.slice(0)}}t.__esModule=!0,t.default=n,n.prototype={diff:function(e,t){function n(e){return l?(setTimeout(function(){l(void 0,e)},0),!0):e}function o(){for(var o=-1*u;o<=u;o+=2){var a=void 0,l=p[o-1],f=p[o+1],m=(f?f.newPos:0)-o;l&&(p[o-1]=void 0);var h=l&&l.newPos+1<c,v=f&&0<=m&&m<d;if(h||v){if(!h||v&&l.newPos<f.newPos?(a=i(f),s.pushComponent(a.components,void 0,!0)):(a=l,a.newPos++,s.pushComponent(a.components,!0,void 0)),m=s.extractCommon(a,t,e,o),a.newPos+1>=c&&m+1>=d)return n(r(s,a.components,t,e,s.useLongestToken));p[o]=a}else p[o]=void 0}u++}var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=a.callback;"function"==typeof a&&(l=a,a={}),this.options=a;var s=this;e=this.castInput(e),t=this.castInput(t),e=this.removeEmpty(this.tokenize(e)),t=this.removeEmpty(this.tokenize(t));var c=t.length,d=e.length,u=1,f=c+d,p=[{newPos:-1,components:[]}],m=this.extractCommon(p[0],t,e,0);if(p[0].newPos+1>=c&&m+1>=d)return n([{value:this.join(t),count:t.length}]);if(l)!function e(){setTimeout(function(){if(u>f)return l();o()||e()},0)}();else for(;u<=f;){var h=o();if(h)return h}},pushComponent:function(e,t,n){var r=e[e.length-1];r&&r.added===t&&r.removed===n?e[e.length-1]={count:r.count+1,added:t,removed:n}:e.push({count:1,added:t,removed:n})},extractCommon:function(e,t,n,r){for(var i=t.length,o=n.length,a=e.newPos,l=a-r,s=0;a+1<i&&l+1<o&&this.equals(t[a+1],n[l+1]);)a++,l++,s++;return s&&e.components.push({count:s}),e.newPos=a,l},equals:function(e,t){return e===t||this.options.ignoreCase&&e.toLowerCase()===t.toLowerCase()},removeEmpty:function(e){for(var t=[],n=0;n<e.length;n++)e[n]&&t.push(e[n]);return t},castInput:function(e){return e},tokenize:function(e){return e.split("")},join:function(e){return e.join("")}}},function(e,t,n){"use strict";function r(e,t,n){return a.diff(e,t,n)}t.__esModule=!0,t.characterDiff=void 0,t.diffChars=r;var i=n(1),o=function(e){return e&&e.__esModule?e:{default:e}}(i),a=t.characterDiff=new o.default},function(e,t,n){"use strict";function r(e,t,n){return n=(0,l.generateOptions)(n,{ignoreWhitespace:!0}),d.diff(e,t,n)}function i(e,t,n){return d.diff(e,t,n)}t.__esModule=!0,t.wordDiff=void 0,t.diffWords=r,t.diffWordsWithSpace=i;var o=n(1),a=function(e){return e&&e.__esModule?e:{default:e}}(o),l=n(4),s=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,c=/\S/,d=t.wordDiff=new a.default;d.equals=function(e,t){return this.options.ignoreCase&&(e=e.toLowerCase(),t=t.toLowerCase()),e===t||this.options.ignoreWhitespace&&!c.test(e)&&!c.test(t)},d.tokenize=function(e){for(var t=e.split(/(\s+|\b)/),n=0;n<t.length-1;n++)!t[n+1]&&t[n+2]&&s.test(t[n])&&s.test(t[n+2])&&(t[n]+=t[n+2],t.splice(n+1,2),n--);return t}},function(e,t){"use strict";function n(e,t){if("function"==typeof e)t.callback=e;else if(e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}t.__esModule=!0,t.generateOptions=n},function(e,t,n){"use strict";function r(e,t,n){return s.diff(e,t,n)}function i(e,t,n){var r=(0,l.generateOptions)(n,{ignoreWhitespace:!0});return s.diff(e,t,r)}t.__esModule=!0,t.lineDiff=void 0,t.diffLines=r,t.diffTrimmedLines=i;var o=n(1),a=function(e){return e&&e.__esModule?e:{default:e}}(o),l=n(4),s=t.lineDiff=new a.default;s.tokenize=function(e){var t=[],n=e.split(/(\n|\r\n)/);n[n.length-1]||n.pop();for(var r=0;r<n.length;r++){var i=n[r];r%2&&!this.options.newlineIsToken?t[t.length-1]+=i:(this.options.ignoreWhitespace&&(i=i.trim()),t.push(i))}return t}},function(e,t,n){"use strict";function r(e,t,n){return a.diff(e,t,n)}t.__esModule=!0,t.sentenceDiff=void 0,t.diffSentences=r;var i=n(1),o=function(e){return e&&e.__esModule?e:{default:e}}(i),a=t.sentenceDiff=new o.default;a.tokenize=function(e){return e.split(/(\S.+?[.!?])(?=\s+|$)/)}},function(e,t,n){"use strict";function r(e,t,n){return a.diff(e,t,n)}t.__esModule=!0,t.cssDiff=void 0,t.diffCss=r;var i=n(1),o=function(e){return e&&e.__esModule?e:{default:e}}(i),a=t.cssDiff=new o.default;a.tokenize=function(e){return e.split(/([{}:;,]|\s+)/)}},function(e,t,n){"use strict";function r(e,t,n){return d.diff(e,t,n)}function i(e,t,n){t=t||[],n=n||[];var r=void 0;for(r=0;r<t.length;r+=1)if(t[r]===e)return n[r];var a=void 0;if("[object Array]"===c.call(e)){for(t.push(e),a=new Array(e.length),n.push(a),r=0;r<e.length;r+=1)a[r]=i(e[r],t,n);return t.pop(),n.pop(),a}if(e&&e.toJSON&&(e=e.toJSON()),"object"===(void 0===e?"undefined":o(e))&&null!==e){t.push(e),a={},n.push(a);var l=[],s=void 0;for(s in e)e.hasOwnProperty(s)&&l.push(s);for(l.sort(),r=0;r<l.length;r+=1)s=l[r],a[s]=i(e[s],t,n);t.pop(),n.pop()}else a=e;return a}t.__esModule=!0,t.jsonDiff=void 0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.diffJson=r,t.canonicalize=i;var a=n(1),l=function(e){return e&&e.__esModule?e:{default:e}}(a),s=n(5),c=Object.prototype.toString,d=t.jsonDiff=new l.default;d.useLongestToken=!0,d.tokenize=s.lineDiff.tokenize,d.castInput=function(e){var t=this.options.undefinedReplacement;return"string"==typeof e?e:JSON.stringify(i(e),function(e,n){return void 0===n?t:n},"  ")},d.equals=function(e,t){return l.default.prototype.equals.call(d,e.replace(/,([\r\n])/g,"$1"),t.replace(/,([\r\n])/g,"$1"))}},function(e,t,n){"use strict";function r(e,t,n){return a.diff(e,t,n)}t.__esModule=!0,t.arrayDiff=void 0,t.diffArrays=r;var i=n(1),o=function(e){return e&&e.__esModule?e:{default:e}}(i),a=t.arrayDiff=new o.default;a.tokenize=a.join=function(e){return e.slice()}},function(e,t,n){"use strict";function r(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("string"==typeof t&&(t=(0,o.parsePatch)(t)),Array.isArray(t)){if(t.length>1)throw new Error("applyPatch only works with a single input.");t=t[0]}for(var r=e.split(/\r\n|[\n\v\f\r\x85]/),i=e.match(/\r\n|[\n\v\f\r\x85]/g)||[],a=t.hunks,s=n.compareLine||function(e,t,n,r){return t===r},c=0,d=n.fuzzFactor||0,u=0,f=0,p=void 0,m=void 0,h=0;h<a.length;h++){for(var v=a[h],g=r.length-v.oldLines,y=0,w=f+v.oldStart-1,b=(0,l.default)(w,u,g);void 0!==y;y=b())if(function(e,t){for(var n=0;n<e.lines.length;n++){var i=e.lines[n],o=i[0],a=i.substr(1);if(" "===o||"-"===o){if(!s(t+1,r[t],o,a)&&++c>d)return!1;t++}}return!0}(v,w+y)){v.offset=f+=y;break}if(void 0===y)return!1;u=v.offset+v.oldStart+v.oldLines}for(var _=0,x=0;x<a.length;x++){var S=a[x],k=S.oldStart+S.offset+_-1;_+=S.newLines-S.oldLines,k<0&&(k=0);for(var M=0;M<S.lines.length;M++){var A=S.lines[M],E=A[0],L=A.substr(1),D=S.linedelimiters[M];if(" "===E)k++;else if("-"===E)r.splice(k,1),i.splice(k,1);else if("+"===E)r.splice(k,0,L),i.splice(k,0,D),k++;else if("\\"===E){var C=S.lines[M-1]?S.lines[M-1][0]:null;"+"===C?p=!0:"-"===C&&(m=!0)}}}if(p)for(;!r[r.length-1];)r.pop(),i.pop();else m&&(r.push(""),i.push("\n"));for(var I=0;I<r.length-1;I++)r[I]=r[I]+i[I];return r.join("")}function i(e,t){function n(){var o=e[i++];if(!o)return t.complete();t.loadFile(o,function(e,i){if(e)return t.complete(e);var a=r(i,o,t);t.patched(o,a,function(e){if(e)return t.complete(e);n()})})}"string"==typeof e&&(e=(0,o.parsePatch)(e));var i=0;n()}t.__esModule=!0,t.applyPatch=r,t.applyPatches=i;var o=n(11),a=n(12),l=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t){"use strict";function n(e){function t(e){var t=/^(---|\+\+\+)\s+([\S ]*)(?:\t(.*?)\s*)?$/,n=t.exec(i[l]);if(n){var r="---"===n[1]?"old":"new",o=n[2].replace(/\\\\/g,"\\");/^".*"$/.test(o)&&(o=o.substr(1,o.length-2)),e[r+"FileName"]=o,e[r+"Header"]=n[3],l++}}function n(){for(var e=l,t=i[l++],n=t.split(/@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/),a={oldStart:+n[1],oldLines:+n[2]||1,newStart:+n[3],newLines:+n[4]||1,lines:[],linedelimiters:[]},s=0,c=0;l<i.length&&!(0===i[l].indexOf("--- ")&&l+2<i.length&&0===i[l+1].indexOf("+++ ")&&0===i[l+2].indexOf("@@"));l++){var d=i[l][0];if("+"!==d&&"-"!==d&&" "!==d&&"\\"!==d)break;a.lines.push(i[l]),a.linedelimiters.push(o[l]||"\n"),"+"===d?s++:"-"===d?c++:" "===d&&(s++,c++)}if(s||1!==a.newLines||(a.newLines=0),c||1!==a.oldLines||(a.oldLines=0),r.strict){if(s!==a.newLines)throw new Error("Added line count did not match for hunk at line "+(e+1));if(c!==a.oldLines)throw new Error("Removed line count did not match for hunk at line "+(e+1))}return a}for(var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.split(/\r\n|[\n\v\f\r\x85]/),o=e.match(/\r\n|[\n\v\f\r\x85]/g)||[],a=[],l=0;l<i.length;)!function(){var e={};for(a.push(e);l<i.length;){var o=i[l];if(/^(\-\-\-|\+\+\+|@@)\s/.test(o))break;var s=/^(?:Index:|diff(?: -r \w+)+)\s+(.+?)\s*$/.exec(o);s&&(e.index=s[1]),l++}for(t(e),t(e),e.hunks=[];l<i.length;){var c=i[l];if(/^(Index:|diff|\-\-\-|\+\+\+)\s/.test(c))break;if(/^@@/.test(c))e.hunks.push(n());else{if(c&&r.strict)throw new Error("Unknown line "+(l+1)+" "+JSON.stringify(c));l++}}}();return a}t.__esModule=!0,t.parsePatch=n},function(e,t){"use strict";t.__esModule=!0,t.default=function(e,t,n){var r=!0,i=!1,o=!1,a=1;return function l(){if(r&&!o){if(i?a++:r=!1,e+a<=n)return a;o=!0}if(!i)return o||(r=!0),t<=e-a?-a++:(i=!0,l())}}},function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e){var t=!1;e.oldLines=0,e.newLines=0,e.lines.forEach(function(n){if("string"!=typeof n)return void(t=!0);"+"!==n[0]&&" "!==n[0]||e.newLines++,"-"!==n[0]&&" "!==n[0]||e.oldLines++}),t&&(delete e.oldLines,delete e.newLines)}function o(e,t,n){e=a(e,n),t=a(t,n);var r={};(e.index||t.index)&&(r.index=e.index||t.index),(e.newFileName||t.newFileName)&&(l(e)?l(t)?(r.oldFileName=s(r,e.oldFileName,t.oldFileName),r.newFileName=s(r,e.newFileName,t.newFileName),r.oldHeader=s(r,e.oldHeader,t.oldHeader),r.newHeader=s(r,e.newHeader,t.newHeader)):(r.oldFileName=e.oldFileName,r.newFileName=e.newFileName,r.oldHeader=e.oldHeader,r.newHeader=e.newHeader):(r.oldFileName=t.oldFileName||e.oldFileName,r.newFileName=t.newFileName||e.newFileName,r.oldHeader=t.oldHeader||e.oldHeader,r.newHeader=t.newHeader||e.newHeader)),r.hunks=[];for(var i=0,o=0,f=0,p=0;i<e.hunks.length||o<t.hunks.length;){var m=e.hunks[i]||{oldStart:1/0},h=t.hunks[o]||{oldStart:1/0};if(c(m,h))r.hunks.push(d(m,f)),i++,p+=m.newLines-m.oldLines;else if(c(h,m))r.hunks.push(d(h,p)),o++,f+=h.newLines-h.oldLines;else{var v={oldStart:Math.min(m.oldStart,h.oldStart),oldLines:0,newStart:Math.min(m.newStart+f,h.oldStart+p),newLines:0,lines:[]};u(v,m.oldStart,m.lines,h.oldStart,h.lines),o++,i++,r.hunks.push(v)}}return r}function a(e,t){if("string"==typeof e){if(/^@@/m.test(e)||/^Index:/m.test(e))return(0,x.parsePatch)(e)[0];if(!t)throw new Error("Must provide a base reference or pass in a patch");return(0,_.structuredPatch)(void 0,void 0,t,e)}return e}function l(e){return e.newFileName&&e.newFileName!==e.oldFileName}function s(e,t,n){return t===n?t:(e.conflict=!0,{mine:t,theirs:n})}function c(e,t){return e.oldStart<t.oldStart&&e.oldStart+e.oldLines<t.oldStart}function d(e,t){return{oldStart:e.oldStart,oldLines:e.oldLines,newStart:e.newStart+t,newLines:e.newLines,lines:e.lines}}function u(e,t,n,o,a){var l={offset:t,lines:n,index:0},s={offset:o,lines:a,index:0};for(h(e,l,s),h(e,s,l);l.index<l.lines.length&&s.index<s.lines.length;){var c=l.lines[l.index],d=s.lines[s.index];if("-"!==c[0]&&"+"!==c[0]||"-"!==d[0]&&"+"!==d[0])if("+"===c[0]&&" "===d[0]){var u;(u=e.lines).push.apply(u,r(g(l)))}else if("+"===d[0]&&" "===c[0]){var y;(y=e.lines).push.apply(y,r(g(s)))}else"-"===c[0]&&" "===d[0]?p(e,l,s):"-"===d[0]&&" "===c[0]?p(e,s,l,!0):c===d?(e.lines.push(c),l.index++,s.index++):m(e,g(l),g(s));else f(e,l,s)}v(e,l),v(e,s),i(e)}function f(e,t,n){var i=g(t),o=g(n);if(w(i)&&w(o)){if((0,S.arrayStartsWith)(i,o)&&b(n,i,i.length-o.length)){var a;return void(a=e.lines).push.apply(a,r(i))}if((0,S.arrayStartsWith)(o,i)&&b(t,o,o.length-i.length)){var l;return void(l=e.lines).push.apply(l,r(o))}}else if((0,S.arrayEqual)(i,o)){var s;return void(s=e.lines).push.apply(s,r(i))}m(e,i,o)}function p(e,t,n,i){var o=g(t),a=y(n,o);if(a.merged){var l;(l=e.lines).push.apply(l,r(a.merged))}else m(e,i?a:o,i?o:a)}function m(e,t,n){e.conflict=!0,e.lines.push({conflict:!0,mine:t,theirs:n})}function h(e,t,n){for(;t.offset<n.offset&&t.index<t.lines.length;){var r=t.lines[t.index++];e.lines.push(r),t.offset++}}function v(e,t){for(;t.index<t.lines.length;){var n=t.lines[t.index++];e.lines.push(n)}}function g(e){for(var t=[],n=e.lines[e.index][0];e.index<e.lines.length;){var r=e.lines[e.index];if("-"===n&&"+"===r[0]&&(n="+"),n!==r[0])break;t.push(r),e.index++}return t}function y(e,t){for(var n=[],r=[],i=0,o=!1,a=!1;i<t.length&&e.index<e.lines.length;){var l=e.lines[e.index],s=t[i];if("+"===s[0])break;if(o=o||" "!==l[0],r.push(s),i++,"+"===l[0])for(a=!0;"+"===l[0];)n.push(l),l=e.lines[++e.index];s.substr(1)===l.substr(1)?(n.push(l),e.index++):a=!0}if("+"===(t[i]||"")[0]&&o&&(a=!0),a)return n;for(;i<t.length;)r.push(t[i++]);return{merged:r,changes:n}}function w(e){return e.reduce(function(e,t){return e&&"-"===t[0]},!0)}function b(e,t,n){for(var r=0;r<n;r++){var i=t[t.length-n+r].substr(1);if(e.lines[e.index+r]!==" "+i)return!1}return e.index+=n,!0}t.__esModule=!0,t.calcLineCount=i,t.merge=o;var _=n(14),x=n(11),S=n(15)},function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t,n,i,o,a,s){function c(e){return e.map(function(e){return" "+e})}s||(s={}),void 0===s.context&&(s.context=4);var d=(0,l.diffLines)(n,i,s);d.push({value:"",lines:[]});for(var u=[],f=0,p=0,m=[],h=1,v=1,g=0;g<d.length;g++)!function(e){var t=d[e],o=t.lines||t.value.replace(/\n$/,"").split("\n");if(t.lines=o,t.added||t.removed){var a;if(!f){var l=d[e-1];f=h,p=v,l&&(m=s.context>0?c(l.lines.slice(-s.context)):[],f-=m.length,p-=m.length)}(a=m).push.apply(a,r(o.map(function(e){return(t.added?"+":"-")+e}))),t.added?v+=o.length:h+=o.length}else{if(f)if(o.length<=2*s.context&&e<d.length-2){var g;(g=m).push.apply(g,r(c(o)))}else{var y,w=Math.min(o.length,s.context);(y=m).push.apply(y,r(c(o.slice(0,w))));var b={oldStart:f,oldLines:h-f+w,newStart:p,newLines:v-p+w,lines:m};if(e>=d.length-2&&o.length<=s.context){var _=/\n$/.test(n),x=/\n$/.test(i);0!=o.length||_?_&&x||m.push("\\ No newline at end of file"):m.splice(b.oldLines,0,"\\ No newline at end of file")}u.push(b),f=0,p=0,m=[]}h+=o.length,v+=o.length}}(g);return{oldFileName:e,newFileName:t,oldHeader:o,newHeader:a,hunks:u}}function o(e,t,n,r,o,a,l){var s=i(e,t,n,r,o,a,l),c=[];e==t&&c.push("Index: "+e),c.push("==================================================================="),c.push("--- "+s.oldFileName+(void 0===s.oldHeader?"":"\t"+s.oldHeader)),c.push("+++ "+s.newFileName+(void 0===s.newHeader?"":"\t"+s.newHeader));for(var d=0;d<s.hunks.length;d++){var u=s.hunks[d];c.push("@@ -"+u.oldStart+","+u.oldLines+" +"+u.newStart+","+u.newLines+" @@"),c.push.apply(c,u.lines)}return c.join("\n")+"\n"}function a(e,t,n,r,i,a){return o(e,e,t,n,r,i,a)}t.__esModule=!0,t.structuredPatch=i,t.createTwoFilesPatch=o,t.createPatch=a;var l=n(5)},function(e,t){"use strict";function n(e,t){return e.length===t.length&&r(e,t)}function r(e,t){if(t.length>e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}t.__esModule=!0,t.arrayEqual=n,t.arrayStartsWith=r},function(e,t){"use strict";function n(e){for(var t=[],n=void 0,r=void 0,i=0;i<e.length;i++)n=e[i],r=n.added?1:n.removed?-1:0,t.push([r,n.value]);return t}t.__esModule=!0,t.convertChangesToDMP=n},function(e,t){"use strict";function n(e){for(var t=[],n=0;n<e.length;n++){var i=e[n];i.added?t.push("<ins>"):i.removed&&t.push("<del>"),t.push(r(i.value)),i.added?t.push("</ins>"):i.removed&&t.push("</del>")}return t.join("")}function r(e){var t=e;return t=t.replace(/&/g,"&amp;"),t=t.replace(/</g,"&lt;"),t=t.replace(/>/g,"&gt;"),t=t.replace(/"/g,"&quot;")}t.__esModule=!0,t.convertChangesToXML=n}])}),define("view/bind",["config/params","view/ui","controller/store","controller/local","helper/util","diff"],function(e,t,n,r,i,o){var a={addFile:function(){t.loading("add_data",!1),t.e("userinput").value=null,t.hide(["disclaimer","import_xml","import_json","load_fcm"]),a.resetXMLoptions(),t.show("importFile")},getIndicator:function(t,n){var r="neutral";if(e.getParam("indicators")){var i=e.getConfig().indicatorValues[n].type,o=e.getConfig().indicatorValues[n].values;"range"===i&&(t<=o[0]&&(r="bad"),t>o[0]&&t<o[1]&&(r="good"),t>o[1]&&t<o[2]&&(r="medium"),t>o[2]&&(r="bad")),"scale"===i&&(t<=o[0]&&(r="bad"),t>o[0]&&(r="medium"),t>o[1]&&(r="good"))}return'<span class="indicator indicator-'+r+'"></span>'},setClassificationProgress:function(e,n,r){var i=r||"status_cl_bar",o=n||"status_cl";t.show(i,"inline-block"),t.e(o).style="width:"+e,t.e(o)["data-tooltip"]=e},showNewModal:function(){t.e("new-modal").classList.add("active"),t.click(["new-modal-x","new-modal-overlay","new-modal-cancel"],function(e){t.loading(e.target.id,!1),t.e("new-modal").classList.remove("active")})},showDiffModal:function(){t.e("diff-modal").classList.add("active"),t.click(["diff-modal-x","diff-modal-overlay","diff-modal-cancel"],function(e){t.loading(e.target.id,!1),t.e("diff-modal").classList.remove("active")})},showLoadModal:function(e){function n(e){t.q("#load-modal .tab-item a").forEach(function(e){e.classList.remove("active"),t.hide("load-"+e.id)}),t.e(e).classList.add("active"),t.show("load-"+e,"flex")}t.e("load-modal").classList.add("active"),t.show("no-local-models"),t.hide("load_localModel"),t.click(["load-modal-x","load-modal-overlay"],function(e){t.loading(e.target.id,!1),t.e("load-modal").classList.remove("active")}),e&&e.length>0?(a.showLocalModels(e),n("from-browser")):n("from-filesystem"),t.q("#load-modal .tab-item").forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),n(e.target.id)})})},showSettingsModal:function(){var n=e.getWritableConfig();t.empty("settings"),Object.keys(n).forEach(function(r){var o=n[r],a=t.create("tr"),l=t.create("th"),s=t.create("td");switch(l.innerText=o.label,t.append(a,[l,s]),o.type){case"list":var c=t.create("select");c.id="setting-"+r,t.append(s,c),t.append(t.e("settings"),a),i.requireCSS("vendor/selectize.css"),require(["selectize"],function(t){$("#setting-"+r).selectize({items:[e.getParam(r)],options:o.values,maxItems:1,onChange:function(t){e.setParam(r,t)}})});break;case"range":var d=t.create("input");d.id="setting-"+r,d.type="range",d.value=e.getParam(r),d.min=o.values.min,d.max=o.values.max,d.step=o.values.step,d.classList.add("slider"),d.classList.add("tooltip"),d.dataset.tooltip=e.getParam(r),t.append(s,d),t.append(t.e("settings"),a),t.bind("setting-"+r,"input",function(t){var n=t.target.value;d.dataset.tooltip=n,e.setParam(r,parseFloat(n))});break;case"boolean":var u=t.create("label"),f=t.create("input"),p=t.create("i");u.classList.add("form-switch"),p.classList.add("form-icon"),f.type="checkbox",f.checked=e.getParam(r),f.id="setting-"+r;var m=e.getParam(r)?"aktiv":"inaktiv",h=t.create("span");h.innerText=m,t.append(u,[f,p,h]),t.append(s,u),t.append(t.e("settings"),a),t.bind("setting-"+r,"change",function(t){var n=t.target.checked;h.innerText=n?"aktiv":"inaktiv",e.setParam(r,n)});break;case"string":var v=t.create("input");v.classList.add("form-input"),v.type="text",v.value=e.getParam(r),v.id="setting-"+r,t.append(s,v),t.append(t.e("settings"),a),t.bind("setting-"+r,"blur",function(t){var n=t.target.value;e.setParam(r,n)});break;default:console.log("skipping complex object")}t.e("set-modal").classList.add("active"),t.loading("change_set"),t.click(["set-modal-x","set-modal-overlay"],function(e){t.loading(e.target.id,!1),t.loading("change_set",!1),t.e("set-modal").classList.remove("active")})})},showLocalModels:function(e){t.hide("no-local-models"),t.show("load_localModel"),i.requireCSS("vendor/selectize.css"),require(["selectize"],function(t){$("#localModel").selectize({options:function(e){return e.map(function(e){return{text:e.name,value:e.id}})}(e),selectOnTab:!0})})},closeModalAndContinue:function(e,n,r){r&&t.loading(r,!1),t.e(e).classList.remove("active"),n&&(window.location.hash=n,"training"===n&&t.unlockPanels())},fillWithDemoData:function(e,n){window.location.hash="training",a.printTrainingAnalysis(e),t.hide(["importFile","downloadMemory"]),t.hide(["prepareClassificationData","downloadResults","userinput_cl","disclaimer_cl"]),t.hide(["panelTitle","panelTitle_cl"]),t.show("disclaimer_demo"),t.show("import_demo"),t.e("textinput").value=n},printTrainingAnalysis:function(e){t.show(["manageModel","trainingAnalysis"]),t.hide(["importFile","xmlAnalysis","panelTitle","prepareTrainingData"]);var r=Math.round(e.trainingDuration/10)/100;n.model.meta.modelName&&(t.e("model-name").innerText=n.model.meta.modelName),a.clearTrainingAnalysis(),t.content({tA_cnt:e.analyzedObjects+a.getIndicator(e.analyzedObjects,"nrOfObjects"),tA_cls:e.analyzedClasses+a.getIndicator(e.analyzedClasses,"nrOfClasses"),tA_avg:e.averageWordCount+a.getIndicator(e.averageWordCount,"sizeOfObjects"),tA_tme:r+"s"+a.getIndicator(r,"timeElapsed")}),require(["view/plot"],function(t){t.pieChartClassDistribution("tA_plot",e.classDistribution)})},clearModel:function(){t.hide(["trainingAnalysis","xmlAnalysis"]),t.show(["importFile"]),a.clearTrainingAnalysis(),t.e("userinput").value=null},clearTrainingAnalysis:function(){t.content({tA_cnt:"?",tA_cls:"?",tA_avg:"?",tA_tme:"?"}),t.empty("tA_plot")},printReportAnalysis:function(e){t.show(["reportAnalysis","manageReport"]),t.hide(["importFile_rp","panelTitle_rp","xmlAnalysis_rp","reportSettings"]),e.meta.reportName&&(t.e("report-name").innerText=e.meta.reportName);var n=Math.round(e.meta.timeElapsed/10)/100,r=e.data.sources.length,i=r*(r-1)/2,o=e.data.results.map(function(e){return e[0]});t.content({rA_idf:e.data.results.length,rA_cnt:r,rA_com:i,rA_tme:n+"s"}),require(["view/plot"],function(t){t.histogramSimDist("rA_histogramChart",o),t.forceDirectedGraph("rA_graph",e.data.mapping),t.dataTableSimilarities("rA_table",e.data),a.enableDiffingBtns(),a.enableGroupBtns()})},enableDiffingBtns:function(){t.qA(".diff").forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),a.showDiffingViewWithWorker(e.target.dataset,e.target.id)})})},enableGroupBtns:function(){t.qA(".group").forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),require(["view/plot"],function(t){t.filterDataTableSimilarities("rA_table",e.target.innerText)})})})},showDiffingView:function(e,r){var l,s,c,d,u=e.source,f=e.target;t.loading(r),n.repSimilarModules.data.sources.forEach(function(e){e.xid===u&&(l=e.txt,c=e.dsc),e.xid===f&&(s=e.txt,d=e.dsc)});var p=o.diffWords(l,s);t.empty("diff-body");var m=t.e("diff-body"),h=document.createDocumentFragment(),v=0,g=0;p.forEach(function(e){var t=!(!e.added&&!e.removed),n=e.added?"text-primary":e.removed?"text":"text-secondary",r=document.createElement("span");r.classList.add(n),t&&r.classList.add("mod"),e.added&&v++,e.removed&&g++,r.appendChild(document.createTextNode(e.value)),h.appendChild(r)});var y=c,w="";c!==d&&(w="<br/>"+d),t.content({"diff-details-t":y,"diff-details-ta":w,"diff-details-a":e.source,"diff-details-b":e.target,"diff-details-v":i.percent(e.value,1,4),"diff-details-p":"+"+v,"diff-details-m":"-"+g}),t.empty("diff-details-weighted-content"),n.repSimilarModules.meta.weightedElements&&0!==n.repSimilarModules.meta.weightedElements.length?(t.show("diff-details-weighted"),n.repSimilarModules.meta.weightedElements.forEach(function(e){var n=t.create("small");n.classList.add("label","label-warning"),n.innerText=e,t.append(t.e("diff-details-weighted-content"),n)})):t.hide("diff-details-weighted"),m.appendChild(h),a.showDiffModal(),t.loading(r)},showDiffingViewWithWorker:function(r,o){t.loading(o);var s,c,d,u,f=r.source,p=r.target;n.repSimilarModules.data.sources.forEach(function(e){e.xid===f&&(s=e.txt,d=e.dsc),e.xid===p&&(c=e.txt,u=e.dsc)});var m=new Worker(e.getParam("dfWorkerURL"));m.addEventListener("error",function(e){t.showModal(l("work_proc_pdf"))}),m.addEventListener("message",function(e){if(e.data.ready)m.postMessage(["diffData",s,c]);else{var l=e.data[0];m.terminate(),t.empty("diff-body");var f=t.e("diff-body"),p=document.createDocumentFragment(),h=0,v=0;l.forEach(function(e){var t=!(!e.added&&!e.removed),n=e.added?"text-primary":e.removed?"text":"text-secondary",r=document.createElement("span");r.classList.add(n),t&&r.classList.add("mod"),e.added&&h++,e.removed&&v++,r.appendChild(document.createTextNode(e.value)),p.appendChild(r)});var g=d,y="";d!==u&&(y="<br/>"+u),t.content({"diff-details-t":g,"diff-details-ta":y,"diff-details-a":r.source,"diff-details-b":r.target,"diff-details-v":i.percent(r.value,1,4),"diff-details-p":"+"+h,"diff-details-m":"-"+v}),
t.empty("diff-details-weighted-content"),n.repSimilarModules.meta.weightedElements&&0!==n.repSimilarModules.meta.weightedElements.length?(t.show("diff-details-weighted"),n.repSimilarModules.meta.weightedElements.forEach(function(e){var n=t.create("small");n.classList.add("label","label-warning"),n.innerText=e,t.append(t.e("diff-details-weighted-content"),n)})):t.hide("diff-details-weighted"),f.appendChild(p),a.showDiffModal(),t.loading(o)}})},printClassificationAnalysis:function(e,r){t.show(["manageClassification","classificationAnalysis"]),t.hide("classificationData","xmlAnalysis_cl","panelTitle_cl"),t.content({clModelName:n.model.meta.modelName,classifiedFile:n.classifiedFileSources.join(", ")+"  (Typ: "+r.toUpperCase()+")"});var i=Math.round(e.tme/10)/100;t.content({cA_cnt:e.cnt,cA_tme:i+"s",cA_cls:e.dis.length,cAM_cls:n.model.meta.analyzedClasses}),require(["view/plot"],function(n){t.empty(["cA_plot","cA_histogramChart"]),n.pieChartClassDistribution("cA_plot",e.dis),n.histogramConfDist("cA_histogramChart",e.arr),"pdf"===r&&(t.show(["classDistributionAnalysis","confidenceAnalysis"]),n.scatterPlotClassDist("cA_scatterPlot",e.arr),n.lineChartConfidenceTrans("cA_lineChart",e.arr))})},printClassificationAnalysisText:function(e){t.show("classificationAnalysisText");var n=Math.round(e.time/10)/100;t.content({cAT_clf:e.pred,cAT_cfd:e.conf+"%",cAT_tme:n+"s"}),require(["view/plot"],function(n){t.empty("cAT_plot"),n.barChartClassScores("cAT_plot",e.info)})},prepareQualityAnalysis:function(e){t.show("qsAnalysis","flex"),e[0]&&t.show("tA_svl_panel","flex"),e[1]&&t.show("tA_cvl_panel","flex"),t.loading("qs")},printQualityScore:function(e,n){t.content("tA_"+e,n+"%"),require(["view/plot"],function(r){t.empty("tA_"+e+"_g"),r.pieChartGauge("tA_"+e+"_g",n)})},resetXMLoptions:function(e){var t=e?"_cl":"";i.requireCSS("vendor/selectize.css"),require(["selectize"],function(e){var n=$("#xmlAttr"+t).selectize();selectElemInstance=$("#xmlElem"+t).selectize(),n&&selectElemInstance&&(n[0].selectize.clearOptions(),selectElemInstance[0].selectize.clearOptions())})},printXMLoptions:function(n,r){var o="";"classify"===r&&(o="_cl"),"report"===r&&(o="_rp");var a=Object.keys(n).sort();i.requireCSS("vendor/selectize.css"),require(["selectize"],function(i){function l(e){return e.map(function(e){return{text:e,value:e}})}function s(){var e=[],r=[];t.q("#xmlElem"+o+" option:checked").forEach(function(t){e.push(t.value)});for(var i=0;i<e.length;i++){var a=e[i],s=Object.keys(n[a]);r=i>0?r.filter(function(e){return s.includes(e)}):r.concat(s)}return l(r.sort())}function c(){var e=s(),t=$("#xmlAttr"+o).selectize();t[0].selectize.clearOptions(),t[0].selectize.addOption(e),t[0].selectize.refreshOptions()}if(t.show("xmlAnalysis"+o),"classify"!==r){var d=e.getParam("signalsEnabled");t.show("showSignalSelection"+o),t.e("showSignalSelection"+o).checked=e.getParam("signalsEnabled"),d&&$("#signalSelection"+o).show(),t.click("showSignalSelection"+o,function(){e.setParam("signalsEnabled",t.e("showSignalSelection"+o).checked),$("#signalSelection"+o).toggle()}),$("#xmlElemSignal"+o).selectize({options:l(a)})}$("#xmlAttr"+o).selectize({options:[],onChange:function(e){""!==e?t.show("import_xml"+o):t.hide("import_xml"+o)}}),$("#xmlElem"+o).selectize({options:l(a),selectOnTab:!0,onChange:function(){c()}})})},getXMLoptions:function(e){var r="";"classify"===e&&(r="_cl"),"report"===e&&(r="_rp");var i=t.e("xmlAttr"+r).value,o=[],a=[];return t.q("#xmlElem"+r+" option:checked").forEach(function(e){o.push(e.value)}),"classify"!==e&&t.q("#xmlElemSignal"+r+" option:checked").forEach(function(e){a.push(e.value)}),n.xmlParsingSettings=[o,i,a],n.xmlParsingSettings},getQSoptions:function(){return[t.e("tA_svl_mode").checked,t.e("tA_cvl_mode").checked]},getTextFromUserInput:function(){return t.e("textinput").value.replace(/(\r?\n)+|(\r)+/g," ")},createMenuItem:function(e,n,r){var i=t.e(e),o=t.create("li"),a=t.create("a");o.classList.add("menu-item"),a.classList.add("no-link"),a.href="#",a.id=n,a.innerText=r,t.append(i,o),t.append(o,a)}};return a}),define("controller/work",["config/params","view/ui","view/bind","controller/store","helper/util","helper/l10n"],function(e,t,n,r,i,o){var a={processPDF:function(n,i){var a=new Worker(e.getParam("fcWorkerURL"));a.addEventListener("error",function(e){t.showModal(o("work_proc_pdf"))}),a.addEventListener("message",function(e){e.data.ready?a.postMessage(["chunkPDF",n,r.model.meta.averageWordCount]):(r.inputDataCl=e.data,r.pdfArrayBuffer[i]=null,t.loading("import_pdf_cl"),a.terminate())})},processBulkPDF:function(n,i){var a=new Worker(e.getParam("fcWorkerURL"));a.addEventListener("error",function(e){t.showModal(o("work_proc_pdf"))}),a.addEventListener("message",function(o){if(o.data.ready)a.postMessage(["processPDF",n]);else{var l=o.data;a.terminate();var s={xid:i,txt:l,dsc:i};r.pdfArrayBuffer[i]=null,r.inputDataRp.push(s),r.inputDataRp.length===r.pdfBulkFiles.length&&(t.hide("import_rp"),t.show(["import_pdf_rp","threshold_autoadjust"]),e.setParam("similarityThreshold",0))}})},getSimilarityReport:function(l){if(r.inputDataRp&&0!==r.inputDataRp.length){var s=new Worker(e.getParam("smWorkerURL"));s.addEventListener("error",function(e){t.showModal(o("work_proc_dupes"))}),s.addEventListener("message",function(o){o.data.ready?s.postMessage(["findSimilar",r.inputDataRp,e.getConfig()]):(r.repSimilarModules.data.sources=r.inputDataRp,r.repSimilarModules.meta.reportCreated=i.getDateString(),r.repSimilarModules.meta.timeElapsed=o.data[1],r.repSimilarModules.conf=e.getConfig(),r.repSimilarModules.data.results=o.data[0],r.repSimilarModules.data.mapping=o.data[2],"xml"===l&&(r.repSimilarModules.meta.weightedElements=r.xmlParsingSettings[2]),o.data[0].length>0?n.printReportAnalysis(r.repSimilarModules):t.showModal("Überprüfen Sie den eingestellten Grenzwert","Keine Ergebnisse"),t.loading("import_"+l+"_rp"),a.registerExportHandlers("report"),s.terminate())})}else t.showModal(o("work_no_userdata")),t.loading("import_"+l+"_rp")},trainModel:function(l){function s(e,o){r.model.data.matrix=e[0],r.model.data.object=e[1],r.model.meta.analyzedFiles=r.model.meta.analyzedFiles+1||1,r.model.meta.analyzedObjects=e[1]["@cnt"],r.model.meta.analyzedClasses=e[1]["@cls"],r.model.meta.averageWordCount=e[1]["@avg"],r.model.meta.trainingDuration=i.getTime()-d,r.model.meta.classDistribution=i.getClassDistribution(r.model.data.object),t.loading("import_"+l),n.printTrainingAnalysis(r.model.meta),t.unlockPanels(),a.registerExportHandlers("train"),o.terminate()}if(r.inputData&&0!==r.inputData.length){var c=new Worker(e.getParam("fcWorkerURL")),d=i.getTime();c.addEventListener("error",function(e){t.showModal(o("work_proc_userdata"))}),c.addEventListener("message",function(e){e.data.ready?c.postMessage(["trainFromScratch",r.inputData,r.model.data.object]):s(e.data,c)})}else t.showModal(o("work_no_userdata")),t.loading("import_"+l)},classifyUserInput:function(l){if(r.inputDataCl&&0!==r.inputDataCl.length){var s=new Worker(e.getParam("fcWorkerURL"));s.addEventListener("error",function(e){t.showModal(o("work_class_userdata"))}),s.addEventListener("message",function(o){if(o.data.ready)s.postMessage(["classifyMultiple",r.inputDataCl,r.model.data.matrix]);else if("result"===o.data[0]){r.classifiedData=o.data[1][0];var c=0,d=o.data[1][1];r.classifiedData.forEach(function(t){t.cfd>=e.getParam("confidenceThreshold")&&c++}),n.printClassificationAnalysis({cnt:r.classifiedData.length,tme:d,cfd:c,dis:i.getClassDistribution(r.classifiedData),arr:r.classifiedData},l),t.hide("status_cl"),t.loading("import_"+l+"_cl"),a.registerExportHandlers("classify"),s.terminate()}else if("status"===o.data[0]){var u=o.data[1][0],f=o.data[1][1];n.setClassificationProgress(i.percent(u,f))}})}else t.showModal(o("work_no_classdata")),t.loading("import_"+l+"_cl")},getQualityScores:function(i){var a=i[0],l=i[1];if(r.model.meta.qsQuality&&r.model.meta.qsForecast)n.prepareQualityAnalysis(i),n.printQualityScore("svl",r.model.meta.qsQuality),n.printQualityScore("cvl",r.model.meta.qsForecast),t.loading("qs",!1);else if(r.model.data.matrix&&0!==r.model.data.matrix.length){if(n.prepareQualityAnalysis(i),a){var s=new Worker(e.getParam("fcWorkerURL"));s.addEventListener("error",function(e){t.showModal(o("quality_score_svl"))}),s.addEventListener("message",function(e){if(e.data.ready)s.postMessage(["selfValidate",r.inputData,r.model.data.matrix]);else{var i=e.data[0];e&&i>0?(r.model.meta.qsQuality=e.data[0],r.repProblematicModules=e.data[1],n.printQualityScore("svl",i),t.show("downloadQSreport")):t.showModal(o("quality_score_svl")),s.terminate()}})}if(l){var c=new Worker(e.getParam("fcWorkerURL"));c.addEventListener("error",function(e){t.showModal(o("quality_score_cvl"))}),c.addEventListener("message",function(e){if(e.data.ready)c.postMessage(["crossValidate",r.inputData]);else{var i=e.data[0];e&&i>0?(r.model.meta.qsForecast=e.data[0],r.model.meta.qsCvlScores=e.data[1],r.model.meta.qsCvlDeviation=e.data[2],n.printQualityScore("cvl",i)):t.showModal(o("quality_score_cvl")),c.terminate()}})}}else t.showModal(o("routing_model")),t.loading("qs",!1)},classifyTextInput:function(i){if(r.model.data.matrix&&0!==Object.keys(r.model.data.matrix).length)if(i&&""!==i)if(i.split(/\s+/).length>=3){var a=new Worker(e.getParam("fcWorkerURL"));a.addEventListener("error",function(e){t.showModal(o("authoring_error"))}),a.addEventListener("message",function(e){e.data.ready?a.postMessage(["classifyText",i,r.model.data.matrix]):(t.loading("classify_textinput"),n.printClassificationAnalysisText(e.data),a.terminate())})}else t.showModal(o("authoring_text_min")),t.loading("classify_textinput");else t.showModal(o("authoring_no_text")),t.loading("classify_textinput");else t.showModal(o("routing_model")),t.loading("classify_textinput")},registerExportHandlers:function(o){e.getParam("enabledExports")[o].forEach(function(e){-1===r.registeredHandlers.indexOf(e)&&require(["controller/export/"+e],function(a){if(a.condition()){var l=a.register();n.createMenuItem("exports-"+o,"export-"+e,l.label),t.click("export-"+e,function(n){n.preventDefault(),a.execute().then(function(e){if(l.hasOwnProperty("extension")){var t="json"===l.extension.toLowerCase(),n=i.createFileName(l.filename)+"."+l.extension;i.downloadFile(e,n,!t)}}).catch(function(e){t.showModal("Oh Shit! "+e)}).finally(function(){t.loading("export-"+e,!1)})}),r.registeredHandlers.push(e)}else t.showModal("I'm afraid I can't do that, Dave")})})}};return a}),define("controller/file",["helper/util","view/ui","view/bind","controller/work","controller/store","helper/l10n"],function(e,t,n,r,i,o){var a={readFromInput:function(n,r){if(0!==n.files.length){var l=n.files[0],s=l.name.toLowerCase(),c=s.substring(s.lastIndexOf(".")+1),d=l.name.substring(0,l.name.lastIndexOf(".")),u=new FileReader;if(i.model.meta.modelID||(i.model.meta.modelName=d,i.model.meta.modelID=e.getUUID(),i.model.meta.modelCreated=e.getDateString(),i.model.meta.modelCreator="fastclass Studio",i.model.meta.modelVersion="0.2",t.e("model-name").innerText=d),u.addEventListener("load",function(){a.parseUserInput(u.result,c,r)}),u.addEventListener("error",function(){t.showModal(o("file_format_support"))}),"classify"===r&&(i.classifiedFileCurrentType=c,i.classifiedFileSources.push(d)),"report"===r){var f=l.name.substring(0,l.name.lastIndexOf("."));i.repSimilarModules.meta.reportID=e.getUUID(),i.repSimilarModules.meta.reportName=f,t.e("report-name").innerText=f}"json"===c||"xml"===c?u.readAsText(l):"fcm"===c||"fcr"===c||"zip"===c||"pdf"===c&&"classify"===r?u.readAsArrayBuffer(l):t.showModal(o("file_format_no_support"))}else t.showModal(o("file_no_file"))},parseUserInput:function(e,n,r){"classify"===r?("json"===n?(a.parseJSON(e,r),t.show("import_json_cl")):"xml"===n?a.analyzeXML(e,r):"pdf"===n?(a.preparePDF(e,"main",r),t.show("import_pdf_cl"),t.loading("import_pdf_cl")):t.showModal(o("file_format_no_support")),t.hide("classify")):"report"===r?("json"===n?(a.parseJSON(e,r),t.show("import_json_rp")):"xml"===n?a.analyzeXML(e,r):"zip"===n?a.processZip(e,r):t.showModal(o("file_format_no_support")),t.hide("import_rp")):("fcm"===n?(t.show("load_fcm"),t.loading("load_fcm"),a.loadFCM(e,"load_fcm")):"fcr"===n?a.loadFCR(e,"load_fcm"):"json"===n?(a.parseJSON(e),t.show("import_json")):"xml"===n?a.analyzeXML(e):t.showModal(o("file_format_no_support")),t.hide("import"))},processZip:function(e,n){require(["zip"],function(r){t.show("import_rp","inline"),r.loadAsync(e).then(function(e){Object.keys(e.files).forEach(function(t){i.pdfBulkFiles.push(t),e.file(t).async("arraybuffer").then(function(e){a.preparePDF(e,t,n)})})})})},loadFCM:function(e,r){function a(){"demo"===r?n.fillWithDemoData(i.model.meta,o("demo_text_example")):n.printTrainingAnalysis(i.model.meta),t.loading(r),t.unlockPanels()}require(["zip"],function(n){n.loadAsync(e).then(function(e){e.files.hasOwnProperty("fastclass/model.json")?e.folder("fastclass").file("model.json").async("string").then(function(e){i.model=JSON.parse(e),a()}):t.showModal(o("file_fcm_error"))})})},loadFCR:function(e){require(["zip"],function(r){r.loadAsync(e).then(function(e){e.files.hasOwnProperty("fastclass/report.json")?e.folder("fastclass").file("report.json").async("string").then(function(e){i.repSimilarModules=JSON.parse(e),n.printReportAnalysis(i.repSimilarModules)}):t.showModal(o("file_fcm_error"))})})},parseJSON:function(e,n){try{var r=JSON.parse(e);if(Array.isArray(r)&&0!==r.length){r.every(function(e){return"classify"===n?e.hasOwnProperty("xid")&&e.hasOwnProperty("txt"):e.hasOwnProperty("clf")&&e.hasOwnProperty("txt")})?"classify"===n?i.inputDataCl=r:i.inputData=r:t.showModal(o("file_json_format"))}else t.showModal(o("file_json_empty"))}catch(e){t.showModal(o("file_json_valid")+"<br/>"+o("modal_text_details")+": "+e)}},sanitizeXML:function(e,t){return e.replace(/\&[a-z]+?;/g," ").replace(/<\?xml[A-Z].*?\?>/g,"")},analyzeXML:function(e,o){var l=a.sanitizeXML(e),s=new DOMParser;if(xmlDoc=s.parseFromString(l,"application/xml"),"parsererror"===xmlDoc.documentElement.firstChild.localName)throw xmlDoc.documentElement.firstChild.innerHTML;if("classify"===o?i.xmlDocumentsCl.push(xmlDoc):i.xmlDocuments.push(xmlDoc),"1.0"===xmlDoc.documentElement.getAttribute("fastclass"))t.show(["import_xml","disclaimer"]),t.loading("import_xml"),t.content("disclaimer","fastclass XML v1.0"),"classify"===o?(a.parseXML([["node"],"fc-id",[]],o),r.classifyUserInput("xml")):"report"===o?(a.parseXML([["node"],"fc-id",[]],o),r.getSimilarityReport("xml")):(a.parseXML([["node"],"fc-class",[]],o),r.trainModel("xml"));else if("1.0"===xmlDoc.documentElement.getAttribute("data-fastclass"))t.show(["import_xml","disclaimer"]),t.loading("import_xml"),t.content("disclaimer","fastclass HTML v1.0"),"classify"===o?(a.parseXML([["node"],"data-fc-id",[]],o),r.classifyUserInput("xml")):"report"===o?(a.parseXML([["node"],"data-fc-id",[]],o),r.getSimilarityReport("xml")):(a.parseXML([["node"],"data-fc-class",[]],o),r.trainModel("xml"));else{for(var c=xmlDoc.getElementsByTagName("*"),d={},u={},f=c.length-1;f>=0;f--){var p=c.item(f).tagName;d[p]=!0}for(var m in d){var h="*",v=m;if(-1!==m.indexOf(":")){var g=m.split(":")[0];h=xmlDoc.lookupNamespaceURI(g),v=m.split(":")[1]}for(var y=xmlDoc.getElementsByTagNameNS(h,v),w={},b=y.length-1;b>=0;b--)for(var _=y.item(b).attributes,x=_.length-1;x>=0;x--)w[_.item(x).name]=!0;u[m]=w}i.xmlParsingOptions=u,n.printXMLoptions(u,o)}},parseXML:function(e,n){for(var r="classify"===n?i.xmlDocumentsCl:i.xmlDocuments,o=0;o<r.length;o++){for(var a=r[o],l=e[0]||[],s=e[1]||null,c=e[2]||[],d=l.length-1;d>=0;d--){var u=l[d],f="*",p=u;if(-1!==u.indexOf(":")){var m=u.split(":")[0];f=a.lookupNamespaceURI(m),p=u.split(":")[1]}for(var h=a.getElementsByTagNameNS(f,p),v=h.length-1;v>=0;v--){var g=h.item(v);if(g.hasAttribute(s)&&""!==g.getAttribute(s))if("classify"===n)i.inputDataCl.push({xid:g.getAttribute(s),txt:g.textContent.replace(/[\t\r\n ]+/g," ").replace(/\s+/," ")});else if("report"===n){var y="[no heading defined]",w=g.getElementsByTagNameNS(f,"heading");if(w.length>0&&(y=w.item(0).textContent),c.length>0){for(var b=[],_=0;_<c.length;_++)for(var x=g.getElementsByTagName(c[_]),S=x.length-1;S>=0;S--){var k=x.item(S).textContent.replace(/[\t\r\n ]+|\s\s+/g," ");b.push(k)}i.inputDataRp.push({xid:g.getAttribute(s),txt:g.textContent.replace(/[\t\r\n ]+|\s\s+/g," "),sig:b.join(" "),dsc:y})}else i.inputDataRp.push({xid:g.getAttribute(s),txt:g.textContent.replace(/[\t\r\n ]+|\s\s+/g," "),dsc:y})}else if(c.length>0){for(var M=[],A=0;A<c.length;A++)for(var E=g.getElementsByTagName(c[A]),L=E.length-1;L>=0;L--){var D=E.item(L).textContent.replace(/[\t\r\n ]+|\s\s+/g," ");M.push(D)}i.inputData.push({clf:g.getAttribute(s),txt:g.textContent.replace(/[\t\r\n ]+|\s\s+/g," "),sig:M.join(" ")})}else i.inputData.push({clf:g.getAttribute(s),txt:g.textContent.replace(/[\t\r\n ]+|\s\s+/g," ")})}}i.xmlDocuments.splice(o,1),t.hide()}},preparePDF:function(e,t,n){var o={data:e},a=[];i.pdfArrayBuffer[t]=e,require(["pdfjs-dist/build/pdf"],function(e){e.getDocument({data:o.data}).then(function(e){for(var i=e.numPages,o=0,l=0;l<i;l++)e.getPage(l+1).then(function(e){e.getTextContent().then(function(e){a.push(e),++o===i&&("classify"===n?r.processPDF(a,t):r.processBulkPDF(a,t))})})})})}};return a}),require.config({baseUrl:"scripts",paths:{core:"../../../core/src",conf:"../../../core/src/configs",model:"../../../core/src/model/model",d3:"../vendor/d3",pie:"../vendor/d3pie",mg:"../vendor/metricsgraphics","pdfjs-dist/build/pdf":"../vendor/pdf","pdfjs-dist/build/pdf.worker":"../vendor/pdf.worker",diff:"../vendor/diff",zip:"../vendor/jszip",selectize:"../vendor/selectize",jquery:"../vendor/jquery",sifter:"../vendor/sifter",microplugin:"../vendor/microplugin",localforage:"../vendor/localforage"}}),require(["config/params","model","helper/util","helper/l10n","view/ui","view/bind","controller/file","controller/work","controller/store","controller/local"],function(e,t,n,r,i,o,a,l,s,c){function d(){var e=n.stripURL(window.location.hash);p.includes(e)?i.showPanel(e):i.showModal(r("routing_site_404")+': <b>"'+e+'"</b>',r("modal_title_oops"))}c.init();var u=c.loadSettings();if(null!==u){var f=JSON.parse(u);e.loadConfig(f)}n.browserHasFunctionality()||i.showModal(r("browser_support")+r("browser_alternatives"),r("modal_title_note"));var p=["start","training","quality","report","classify","authoring"];window.addEventListener("hashchange",function(){d()}),""!==window.location.hash&&"#"!==window.location.hash&&d(),document.querySelectorAll(".dropdown-toggle, .no-link").forEach(function(e){e.addEventListener("click",function(e){e.preventDefault()})}),i.click(["modal-ok","modal-x"],i.closeModal),i.click("logo",function(){window.location.hash="",window.location.reload()}),i.bind("model-name","input",function(){s.model.meta.modelName=i.e("model-name").innerText}),i.bind("report-name","input",function(){s.repSimilarModules.meta.reportName=i.e("report-name").innerText}),i.click("demo",function(){i.hide("prepareTrainingData");var t=e.getParam("demoFiles").fcm[n.getLocale()],l=e.getParam("demoFiles").pdf[n.getLocale()];fetch(t).then(function(e){e.ok?e.blob().then(function(e){a.loadFCM(e,"demo")}):i.showModal(r("demo_load_fcm"))}),i.click("import_demo",function(){fetch(l).then(function(e){e.ok?e.json().then(function(e){o.printClassificationAnalysis(e,"pdf"),i.loading("import_demo",!1)}):i.showModal(r("demo_load_pdf"))})})}),i.change("userinput",function(){i.hide(["disclaimer","prepareTrainingData"]),i.show("import","inline-block"),a.readFromInput(i.e("userinput"))}),i.click("import_xml",function(){a.parseXML(o.getXMLoptions()),l.trainModel("xml")}),i.click("import_json",function(){l.trainModel("json")}),i.change("userinput_cl",function(){i.hide(["import_demo","disclaimer_cl","prepareClassificationData"]),i.show("classify","inline"),a.readFromInput(i.e("userinput_cl"),"classify")}),i.click("import_xml_cl",function(){a.parseXML(o.getXMLoptions("classify"),"classify"),l.classifyUserInput("xml")}),i.click("import_json_cl",function(){l.classifyUserInput("json")}),i.click("import_pdf_cl",function(){l.classifyUserInput("pdf")}),i.change("userinput_rp",function(){i.hide(["disclaimer_rp"]),i.show("import_rp","inline"),a.readFromInput(i.e("userinput_rp"),"report")}),i.click("import_xml_rp",function(){a.parseXML(o.getXMLoptions("report"),"report"),l.getSimilarityReport("xml")}),i.click("import_json_rp",function(){l.getSimilarityReport("json")}),i.click("import_pdf_rp",function(){l.getSimilarityReport("pdf")}),i.click("add_data",function(){o.addFile()}),i.click("load_model",function(){o.showLoadModal(c.getModels()),i.loading("load_model");var e=window.location.hash.slice(1)||"training";i.click("load_localModel",function(){c.loadModel(i.e("localModel").value).then(function(t){s.model=t,o.clearModel(),o.printTrainingAnalysis(s.model.meta),o.closeModalAndContinue("load-modal",e,["load_localModel"])})}),i.click("load_fileModel",function(){o.clearModel(),a.readFromInput(i.e("fileModel")),o.closeModalAndContinue("load-modal",e,["load_fileModel"])})}),i.click("new_model",function(){i.loading("new_model"),o.showNewModal(),i.click("new-modal-continue",function(){o.clearModel(),s.model=n.copyObject(s.modelTemplate),i.e("model-name").innerText=r("model_noname"),i.e("new-modal").classList.remove("active"),window.location.hash="training"})}),i.click("clear_data",function(){c.clear().then(function(){i.loading("clear_data")})}),i.click("debug_data",function(){console.dir(s),i.loading("debug_data",!1)}),i.click("classify_textinput",function(){l.classifyTextInput(o.getTextFromUserInput())}),i.click("qs",function(){l.getQualityScores(o.getQSoptions())}),i.click("new_report",function(){window.location.reload(),window.location.hash="#report"}),i.click("load_report",function(){o.showLoadModal(c.getReports()),i.loading("load_report"),i.click("load_localModel",function(){c.loadModel(i.e("localModel").value).then(function(e){s.repSimilarModules=e,o.printReportAnalysis(s.repSimilarModules),o.closeModalAndContinue("load-modal","report",["load_localModel"])})}),i.click("load_fileModel",function(){o.clearModel(),a.readFromInput(i.e("fileModel")),o.closeModalAndContinue("load-modal","report",["load_fileModel"])})}),i.click("change_set",function(){i.loading("change_set"),o.showSettingsModal()}),i.click("reset_set",function(){c.resetSettings(),e.resetConfig(),i.loading("reset_set")}),i.click("export_set",function(){l.exportConfig()})}),define("main",function(){})}();