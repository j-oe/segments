!function(){var n,t,e;!function(r){function i(n,t){return y.call(n,t)}function o(n,t){var e,r,i,o,a,s,f,u,c,l,g,h,p=t&&t.split("/"),v=M.map,d=v&&v["*"]||{};if(n){for(n=n.split("/"),a=n.length-1,M.nodeIdCompat&&b.test(n[a])&&(n[a]=n[a].replace(b,"")),"."===n[0].charAt(0)&&p&&(h=p.slice(0,p.length-1),n=h.concat(n)),c=0;c<n.length;c++)if("."===(g=n[c]))n.splice(c,1),c-=1;else if(".."===g){if(0===c||1===c&&".."===n[2]||".."===n[c-1])continue;c>0&&(n.splice(c-1,2),c-=2)}n=n.join("/")}if((p||d)&&v){for(e=n.split("/"),c=e.length;c>0;c-=1){if(r=e.slice(0,c).join("/"),p)for(l=p.length;l>0;l-=1)if((i=v[p.slice(0,l).join("/")])&&(i=i[r])){o=i,s=c;break}if(o)break;!f&&d&&d[r]&&(f=d[r],u=c)}!o&&f&&(o=f,s=u),o&&(e.splice(0,s,o),n=e.join("/"))}return n}function a(n,t){return function(){var e=w.call(arguments,0);return"string"!=typeof e[0]&&1===e.length&&e.push(null),p.apply(r,e.concat([n,t]))}}function s(n){return function(t){return o(t,n)}}function f(n){return function(t){m[n]=t}}function u(n){if(i(x,n)){var t=x[n];delete x[n],O[n]=!0,h.apply(r,t)}if(!i(m,n)&&!i(O,n))throw new Error("No "+n);return m[n]}function c(n){var t,e=n?n.indexOf("!"):-1;return e>-1&&(t=n.substring(0,e),n=n.substring(e+1,n.length)),[t,n]}function l(n){return n?c(n):[]}function g(n){return function(){return M&&M.config&&M.config[n]||{}}}var h,p,v,d,m={},x={},M={},O={},y=Object.prototype.hasOwnProperty,w=[].slice,b=/\.js$/;v=function(n,t){var e,r=c(n),i=r[0],a=t[1];return n=r[1],i&&(i=o(i,a),e=u(i)),i?n=e&&e.normalize?e.normalize(n,s(a)):o(n,a):(n=o(n,a),r=c(n),i=r[0],n=r[1],i&&(e=u(i))),{f:i?i+"!"+n:n,n:n,pr:i,p:e}},d={require:function(n){return a(n)},exports:function(n){var t=m[n];return void 0!==t?t:m[n]={}},module:function(n){return{id:n,uri:"",exports:m[n],config:g(n)}}},h=function(n,t,e,o){var s,c,g,h,p,M,y,w=[],b=typeof e;if(o=o||n,M=l(o),"undefined"===b||"function"===b){for(t=!t.length&&e.length?["require","exports","module"]:t,p=0;p<t.length;p+=1)if(h=v(t[p],M),"require"===(c=h.f))w[p]=d.require(n);else if("exports"===c)w[p]=d.exports(n),y=!0;else if("module"===c)s=w[p]=d.module(n);else if(i(m,c)||i(x,c)||i(O,c))w[p]=u(c);else{if(!h.p)throw new Error(n+" missing "+c);h.p.load(h.n,a(o,!0),f(c),{}),w[p]=m[c]}g=e?e.apply(m[n],w):void 0,n&&(s&&s.exports!==r&&s.exports!==m[n]?m[n]=s.exports:g===r&&y||(m[n]=g))}else n&&(m[n]=e)},n=t=p=function(n,t,e,i,o){if("string"==typeof n)return d[n]?d[n](t):u(v(n,l(t)).f);if(!n.splice){if(M=n,M.deps&&p(M.deps,M.callback),!t)return;t.splice?(n=t,t=e,e=null):n=r}return t=t||function(){},"function"==typeof e&&(e=i,i=o),i?h(r,n,t,e):setTimeout(function(){h(r,n,t,e)},4),p},p.config=function(n){return p(n)},n._defined=m,e=function(n,t,e){if("string"!=typeof n)throw new Error("See almond README: incorrect module build, no module name");t.splice||(e=t,t=[]),i(m,n)||i(x,n)||(x[n]=[n,t,e])},e.amd={jQuery:!0}}(),e("almond",function(){}),e("modules/tokens",{seperate:function(n,t){var e=t||1;if("string"==typeof n){return n.replace(/([a-z])([A-Z]+)/g,"$1 $2").split(/\s+/g).filter(function(n){return n.length>=e})}return[]},clean:function(n){var t=/[@,\.\-–;:_\?!\\§$%&#\/\(\)=\+±`'‚’„“”"\*´°><^\[\]]+/g;return"string"==typeof n?n.replace(t," "):""},count:function(n){for(var t={},e=0;e<n.length;e++){var r=n[e];t[r]=t[r]+1||1}return t},update:function(n,t,e,r,i){for(var o=e||[],a=r||1,s=i||2.5,f=0;f<t.length;f++){var u=t[f];n[u]=n[u]+a||a,-1!==o.indexOf(u)&&"@"!==u.slice(0,1)&&(n[u]=n[u]+s)}},ngram:function(n,t,e){function r(n,t){var e=t>1?t-1:1,r=[];if(n.length>e)for(var i=0,o=n.length-e;i<o;i++){for(var a=[],s=0;s<t;s++){var f=n[i+s];f&&""!==f&&a.push(f)}a.length===t&&r.push(a.join(" "))}else 1===n.length&&r.push(n[0]);return r}var i=this.clean(n),o=this.seperate(i,e);if(0===parseInt(t)||-3===parseInt(t)){return["@total"].concat(o,r(o,2),r(o,3))}if(-2===parseInt(t)){return["@total"].concat(o,r(o,2))}return["@total"].concat(1===parseInt(t)?o:r(o,parseInt(t)))}}),e("modules/sets",{cln:function(n){return n.filter(function(n){return"number"==typeof n&&!isNaN(n)})},sum:function(n){return n.reduce(function(n,t){return n+t})},max:function(n){return Math.max.apply(Math,n)},min:function(n){return Math.min.apply(Math,n)},avg:function(n){var t=this.cln(n);return this.sum(t)/t.length},srt:function(n){return n.slice(0).sort(function(n,t){return t-n})},sdv:function(n){var t=this.avg(n),e=n.map(function(n){return Math.pow(n-t,2)});return Math.sqrt(1/(n.length-1)*this.sum(e))},sdd:function(n){var t=this.vrc(n);return Math.sqrt(t)},exp:function(n){for(var t=this.sum(n),e=0,r=0;r<n.length;r++)e+=(r+1)*n[r]/t;return e},vrc:function(n){var t=this.exp(n),e=this.sum(n),r=n.map(function(n,r){return Math.pow(r+1-t,2)*(n/e)});return this.sum(r)},smx:function(n){for(var t=[],e=0,r=0;r<n.length;r++)e+=Math.exp(n[r]);for(var i=0;i<n.length;i++)t.push(Math.exp(n[i])/e);return t},unq:function(n){for(var t={},e=0;e<n.length;e++)t[n[e]]=!0;return Object.keys(t)}}),e("modules/vectors",{create:function(n,t){for(var e=[],r=1,i=t.length;r<i;r++){var o=t[r];n.hasOwnProperty(o)?e[r-1]=n[o]:e[r-1]=0}return e},createBulk:function(n,t){for(var e=[],r=t.length,i=[],o=0;o<1e4*Math.floor(r/1e4);o+=1e4)i.push(t.slice(o,o+1e4));i.push(t.slice(r-r%1e4));for(var a=0;a<i.length;a++){var s=this.create(n,i[a]);e.push(s)}return[].concat.apply([],e)},match:function(n,t){for(var e=n.concat(t),r=[],i=0;i<e.length;i++)-1===r.indexOf(e[i])&&r.push(e[i]);return r},dot:function(n,t){for(var e=0,r=0;r<n.length;r++)e+=n[r]*t[r];return e},norm:function(n){return Math.sqrt(this.dot(n,n))},cosine:function(n,t){return this.dot(n,t)/(this.norm(n)*this.norm(t))},custom:function(n,t){return this.dot(n,t)/this.norm(n)*this.norm(t)},l1:function(n,t){for(var e=0,r=0;r<n.length;r++)e+=Math.abs(n[r]-t[r]);return 1/e}}),e("configs/config-core",{nrOfNgrams:2,similarityCalc:"cosine",weightingCalc:"tf-icf-cf",normalizeWeights:!0,tokenWeighting:1,signalsEnabled:!0,signalWeighting:2.5,minNrOfTokens:0,minLengthOfTokens:0}),e("modules/matrix",["configs/config-core","modules/tokens"],function(n,t){var e={w:{"tf-icf-cf":function(n,t,e,r,i,o,a){return Math.log(1+t[n])*Math.log(1+e.length/t[n])*(r/i)},"tf-idf-cf":function(n,t,e,r,i,o,a){return Math.log(1+t[n])*Math.log(1+o/a[n])*(r/i)},"tf-idf":function(n,t,e,r,i,o,a){return t[n]*Math.log(1+o/a[n])},"tf-idf-s":function(n,t,e,r,i,o,a){return Math.log(1+t[n])*Math.log(1+o/a[n])}},init:function(r,i){var o=[],a=[],s={},f=r["@avg"]||0;a.push(f);var u={},c=[];for(var l in r)if("@"!==l.slice(0,1)){c.push(l);for(var g in r[l])u.hasOwnProperty(g)||(u[g]=0),u[g]+=r[l][g]}var h={},p=0;if(-1!==n.weightingCalc.indexOf("idf"))for(var v in i){p++;var d=t.ngram(i[v].txt,n.nrOfNgrams,n.minLengthOfTokens);for(var m in u)-1!==d.indexOf(m)&&(h[m]=h[m]+1||1)}var x={};for(var M in r){"@"!==M.slice(0,1)&&a.push(M),x[M]=0;for(var O in r[M]){var y=r[M][O],w=r[M]["@total"];if("@"!==O.slice(0,1)){var b=e.w[n.weightingCalc](O,u,c,y,w,p,h);x[M]+=b;var k=[M,b];b>0&&(s.hasOwnProperty(O)||(s[O]=[]),s[O].push(k))}}}r=null,o.push(a);var j=a.length;for(var _ in s){for(var R=[_],T=s[_],C=T.length,E=1;E<j;E++)R.push(0);for(var L=0;L<C;L++){var N=T[L],P=N[1],V=N[0],I=a.indexOf(V);n.normalizeWeights&&(P/=x[V]),R[I]=P}o.push(R)}return o},trans:function(n){return n[0].map(function(t,e){return n.map(function(n){return n[e]})})},create:function(n,t){return this.trans(this.init(n,t))}};return e}),e("core/main",["modules/tokens","modules/sets","modules/vectors","modules/matrix","configs/config-core"],function(n,t,e,r,i){return this.fc={version:"1.0.0",train:function(n,t){var e={returnMatrix:!0,returnObj:!1,defaultClass:!1,timeElapsed:!0,extendObj:{}},i=Object.assign({},e,t),o=fc.prepare(n,i.extendObj,i.defaultClass);return i.returnMatrix&&!i.returnObj?r.create(o,n):i.returnMatrix&&i.returnObj?[r.create(o,n),o]:!i.returnMatrix&&i.returnObj?o:[]},extend:function(n,t){return fc.train(n,{extendObj:t,returnObj:!0})},prepare:function(e,r,o){for(var a=r||{},s=0,f=[],u=0,c=0;c<e.length;c++){var l=o||e[c].clf,g=n.ngram(e[c].txt,i.nrOfNgrams,i.minLengthOfTokens),h=[];i.signalsEnabled&&e[c].hasOwnProperty("sig")&&(h=n.ngram(e[c].sig,i.nrOfNgrams,i.minLengthOfTokens)),g.length>1+i.minNrOfTokens&&(a.hasOwnProperty(l)||(a[l]={}),n.update(a[l],g,h,i.tokenWeighting,i.signalWeighting),s++,f.push(n.seperate(e[c].txt,i.minLengthOfTokens).length))}return f=f.filter(function(n){return n>0}),u=Math.round(10*t.avg(f))/10,a["@cls"]=Object.keys(a).length,a["@avg"]=u,a["@inp"]=e.length,a["@cnt"]=s,a},classify:function(t,r){for(var o=fc._getTime(),a=n.ngram(t,i.nrOfNgrams,i.minLengthOfTokens,i.encryptTokens),s=e.create(n.count(a),r[0]),f=[null],u=1;u<r.length;u++){var c=r[u].slice(1),l=e[i.similarityCalc](s,c);f.push(l)}for(var g=fc._getClass(f,r),h=fc._getConf(f),p=fc._getTime(),v=p-o,d=[],m=f.length-1;m>=0;m--)null!==f[m]&&d.push({lbl:r[m][0],val:f[m]});return{pred:g,conf:Math.round(h),time:Math.round(v),info:d}},_getClass:function(n,e){var r=n.indexOf(t.max(n));return e[r]?e[r][0]:"CLASSIFICATION_ERROR"},_getConf:function(n){var e=t.srt(n);return(e[0]-e[1])/(e[0]-e[e.length-1])*100||0},_getTime:function(){return"undefined"!=typeof performance?performance.now():Date.now()}},this.fc}),e("utilities/validation",["modules/sets"],function(n){return this.val={config:{crossValidRatio:.1,subsamplingLimit:100},selfValidation:function(n,t){var e=t||fc.train(n),r=val._getResult(n,e);return[val._getRounded(r[0],1),r[1]]},randomSubsampling:function(t){for(var e=Math.round(1/val.config.crossValidRatio),r=[],i=1;r.length<e&&i<val.config.subsamplingLimit;){for(var o=[],a={},s=[],f={},u=0;u<t.length;u++){Math.random()<=val.config.crossValidRatio&&s.length/o.length<=val.config.crossValidRatio?(s.push(t[u]),f[t[u].clf]=!0):(o.push(t[u]),a[t[u].clf]=!0)}var c=fc.train(o);if(Object.keys(f).every(function(n){return-1!==Object.keys(a).indexOf(n)})){var l=val._getResult(s,c)[0];r.push(l)}i++}return[val._getRounded(n.avg(r),1),r]},crossValidation:function(t){var e=Math.round(1/val.config.crossValidRatio),r=[];!function(n){var t,e,r;for(r=n.length;r;r--)t=Math.floor(Math.random()*r),e=n[r-1],n[r-1]=n[t],n[t]=e}(t);for(var i=0;i<e;i++){var o=Math.round(val.config.crossValidRatio*t.length),a=i*o,s=t.slice(a,a+o),f=[].concat(t.slice(0,a),t.slice(a+o)),u=fc.train(f),c=val._getResult(s,u),l=c[0];r.push(l)}return r=n.cln(r),[val._getRounded(n.avg(r),1),r,n.sdv(r)]},leaveOneOut:function(t){for(var e=[],r=0;r<t.length;r++){var i=t.slice(r,r+1),o=[].concat(t.slice(0,r),t.slice(r+1)),a=fc.train(o),s=val._getResult(i,a)[0];e.push(s)}return[val._getRounded(n.avg(e),1),e]},_getResult:function(n,t){for(var e=0,r=[],i=0;i<n.length;i++){var o=n[i].hasOwnProperty("xid")?n[i].xid:"n"+i,a=fc.classify(n[i].txt,t);a.pred===n[i].clf?e++:r.push({object:o,correct:n[i].clf,guessed:a.pred,confidence:a.conf,values:a.info,time:a.time})}return[e/n.length*100,r]},_getRounded:function(n,t){var e=t||0;return Math.round(n*Math.pow(10,e))/Math.pow(10,e)}},val}),e("utilities/pdftext",["modules/tokens"],function(n){return this.pdf={config:{indexShift:.25,avgDeviation:0},chunk:function(t,e){for(var r=pdf._getText(t),i=r[0],o=r[1],a=n.seperate(i),s=Math.round(e+pdf.config.avgDeviation),f=Math.round(s*pdf.config.indexShift),u=[],c=0,l=0,g=0;g<a.length-s;g+=f){var h=a.slice(g,g+s),p=h.join(" ");l++,u.push({xid:"n"+g,idx:l,pos:pdf._getPage(c,o),txt:p}),c+=a.slice(g,g+f).join(" ").length+1}return u},extractText:function(n){var t=pdf._getText(n);return pdf._filterLines(t).join(" ")},_getPage:function(n,t){for(var e=-1,r=0;r<t.length;r++){var i=t[r];n>=i.s&&n<=i.e&&(e=i.p)}return e},_getText:function(n){for(var t=[],e=[],r=0,i=0;i<n.length;i++){for(var o=n[i],a=i+1,s=0,f=0;f<o.items.length;f++){var u=o.items[f].str,c=u.replace(/\s+/g," "),l=c.replace(/(\w)(\-\s)([^u])/g,"$1$3");t.push(l),s+=l.length}e.push({p:a,c:s,s:r,e:r+s}),r+=s}return[t.join(" "),e,t]},_filterLines:function(t,e,r){var i=n.count(t),o=r||10,a=[];for(var s in i)i[s]>e-o&&a.push(s);return t.filter(function(n){return-1===a.indexOf(n)})}},pdf}),t(["core/main","utilities/validation","utilities/pdftext"],function(n,t,e){self.postMessage({ready:!0});var r={trainFromScratch:function(t){self.postMessage(n.train(t,{returnObj:!0}))},trainAndExtend:function(t,e){self.postMessage(n.extend(t,e))},classifyText:function(t,e){self.postMessage(n.classify(t,e))},classifyMultiple:function(t,e){for(var r=performance.now(),i=0;i<t.length;i++){var o=n.classify(t[i].txt,e);t[i].clf=o.pred,t[i].cfd=o.conf,self.postMessage(["status",[i,t.length]])}var a=performance.now(),s=a-r;self.postMessage(["result",[t,s]])},crossValidate:function(n){self.postMessage(t.crossValidation(n))},selfValidate:function(n,e){self.postMessage(t.selfValidation(n,e))},chunkPDF:function(n,t){self.postMessage(e.chunk(n,t))},processPDF:function(n){self.postMessage(e.extractText(n))}};self.addEventListener("message",function(n){var t=n.data[0],e=n.data.splice(1);if(!r.hasOwnProperty(t))throw new Error("No function with name: "+t);r[t].apply(this,e)})}),e("fcWorker",function(){}),t(["fcWorker"])}();